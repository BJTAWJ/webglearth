function h(a){throw a;}var j=void 0,k=!0,n=null,p=!1;function aa(a){return function(b){this[a]=b}}function q(a){return function(){return this[a]}}function ba(a){return function(){return a}}var s,v=this;function w(){}
function ca(a){var b=typeof a;if(b=="object")if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if(c=="[object Window]")return"object";if(c=="[object Array]"||typeof a.length=="number"&&typeof a.splice!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("splice"))return"array";if(c=="[object Function]"||typeof a.call!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if(b=="function"&&typeof a.call=="undefined")return"object";return b}function x(a){return a!==j}function y(a){return a===n}function z(a){return a!=n}function da(a){return ca(a)=="array"}function A(a){var b=ca(a);return b=="array"||b=="object"&&typeof a.length=="number"}function C(a){return typeof a=="string"}function ea(a){return typeof a=="number"}function fa(a){return ca(a)=="function"}function ga(a){a=ca(a);return a=="object"||a=="array"||a=="function"}
function D(a){return a[ia]||(a[ia]=++ja)}var ia="closure_uid_"+Math.floor(Math.random()*2147483648).toString(36),ja=0;function ka(a,b,c){return a.call.apply(a.bind,arguments)}function la(a,b,c){a||h(Error());if(arguments.length>2){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function E(a,b,c){E=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?ka:la;return E.apply(n,arguments)}var F=Date.now||function(){return+new Date};function G(a,b){var c=a.split("."),d=v;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&x(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function H(a,b){function c(){}c.prototype=b.prototype;a.ma=b.prototype;a.prototype=new c};function ma(a){if(!na.test(a))return a;a.indexOf("&")!=-1&&(a=a.replace(oa,"&amp;"));a.indexOf("<")!=-1&&(a=a.replace(pa,"&lt;"));a.indexOf(">")!=-1&&(a=a.replace(qa,"&gt;"));a.indexOf('"')!=-1&&(a=a.replace(ra,"&quot;"));return a}var oa=/&/g,pa=/</g,qa=/>/g,ra=/\"/g,na=/[&<>\"]/;function sa(){return Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^F()).toString(36)}
function ta(a,b){for(var c=0,d=(""+a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=(""+b).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),f=Math.max(d.length,e.length),g=0;c==0&&g<f;g++){var i=d[g]||"",l=e[g]||"",m=RegExp("(\\d*)(\\D*)","g"),r=RegExp("(\\d*)(\\D*)","g");do{var o=m.exec(i)||["","",""],t=r.exec(l)||["","",""];if(o[0].length==0&&t[0].length==0)break;c=((o[1].length==0?0:parseInt(o[1],10))<(t[1].length==0?0:parseInt(t[1],10))?-1:(o[1].length==0?0:parseInt(o[1],10))>(t[1].length==
0?0:parseInt(t[1],10))?1:0)||((o[2].length==0)<(t[2].length==0)?-1:(o[2].length==0)>(t[2].length==0)?1:0)||(o[2]<t[2]?-1:o[2]>t[2]?1:0)}while(c==0)}return c};var I=Array.prototype,ua=I.indexOf?function(a,b,c){return I.indexOf.call(a,b,c)}:function(a,b,c){c=c==n?0:c<0?Math.max(0,a.length+c):c;if(C(a))return!C(b)||b.length!=1?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},J=I.forEach?function(a,b,c){I.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=C(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},va=I.filter?function(a,b,c){return I.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=0,g=C(a)?a.split(""):
a,i=0;i<d;i++)if(i in g){var l=g[i];b.call(c,l,i,a)&&(e[f++]=l)}return e},wa=I.every?function(a,b,c){return I.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=C(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return p;return k};function xa(a,b){var c=ua(a,b),d;(d=c>=0)&&I.splice.call(a,c,1);return d}function ya(a){return I.concat.apply(I,arguments)}function za(a){if(da(a))return ya(a);for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}
function Aa(a,b,c){return arguments.length<=2?I.slice.call(a,b):I.slice.call(a,b,c)}function Ba(a,b){I.sort.call(a,b||Ca)}function Ca(a,b){return a>b?1:a<b?-1:0}function Da(a){for(var b=[],c=0;c<arguments.length;c++){var d=arguments[c];da(d)?b.push.apply(b,Da.apply(n,d)):b.push(d)}return b};function K(a,b,c){return Math.min(Math.max(a,b),c)}function L(a,b){var c=a%b;return c*b<0?c+b:c}function M(a){return a*Math.PI/180}function N(a){return a*180/Math.PI};(function(a){function b(a){for(var b=a.length,c=new Uint8Array(b/4*3|0),i=0,l=0,m=[0,0],r=0,o=0;b--;){var t=a.charCodeAt(i++),u=d[t-43];u!==255&&u!==j&&(m[1]=m[0],m[0]=t,o=o<<6|u,r++,r===4&&(c[l++]=o>>>16,m[1]!==61&&(c[l++]=o>>>8),m[0]!==61&&(c[l++]=o),r=0))}return c.buffer}var c=/\s*;\s*base64\s*(?:;|$)/i,d=new Uint8Array([62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,0,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,
34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51]);if(HTMLCanvasElement&&!HTMLCanvasElement.prototype.kd)HTMLCanvasElement.prototype.kd=function(d,f){f||(f="image/png");if(this.mozGetAsFile)d(this.mozGetAsFile("canvas",f));else{var g=this.toDataURL.apply(this,Array.prototype.slice.call(arguments,1)),i=g.indexOf(","),l=g.substring(i+1),g=c.test(g.substring(0,i)),i=new (a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder);g?i.append(b(l)):i.append(decodeURIComponent(l));d(i.getBlob(f))}}})(self);
var Ea,Fa=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder,Ga=window.URL||window.webkitURL||window.mozURL,Ha=navigator.saveBlob||navigator.mozSaveBlob||navigator.webkitSaveBlob,Ia=window.saveAs||window.webkitSaveAs||window.mozSaveAs;
Fa&&(Ia||Ha)?Ea=function(a,b,c){var d=new Fa;d.append(a);a=d.getBlob(c||"application/octet-stream");b||(b="Download.bin");Ia?Ia(a,b):Ha(a,b)}:Fa&&Ga&&(Ea=function(a,b,c){var d,e=new Fa;e.append(a);c||(c="application/octet-stream");"download"in document.createElement("a")?(a=e.getBlob(c),d=Ga.createObjectURL(a),a=document.createElement("a"),a.setAttribute("href",d),a.setAttribute("download",b||"Download.bin"),b=document.createEvent("MouseEvents"),b.initMouseEvent("click",k,k,window,1,0,0,0,0,p,p,p,
p,0,n),a.dispatchEvent(b)):({"image/jpeg":k,"image/png":k,"image/gif":k,"image/svg+xml":k,"image/bmp":k,"image/x-windows-bmp":k,"image/webp":k,"audio/wav":k,"audio/mpeg":k,"audio/webm":k,"audio/ogg":k,"video/mpeg":k,"video/webm":k,"video/ogg":k,"text/plain":k,"text/html":k,"text/xml":k,"application/xhtml+xml":k,"application/json":k}[c.split(";")[0]]===k&&(c="application/octet-stream"),a=e.getBlob(c),d=Ga.createObjectURL(a),window.open(d,"_blank",""));setTimeout(function(){Ga.revokeObjectURL(d)},250)});
function Ja(a,b,c,d){var e=a;if(c||d){e=document.createElement("canvas");e.width=a.width;e.height=a.height;var f=e.getContext("2d");f.drawImage(a,0,0);c&&c.forEach(function(a){a.Bd(f)});d&&Ka(d,f)}if(Ea&&e.kd)e.kd(function(a){Ea(a,b,"image/png")},"image/png");else if(a.toDataURL)a=a.toDataURL(),document.location.href=a.replace("image/png","image/octet-stream")};function La(a,b,c){for(var d in a)b.call(c,a[d],d,a)}function Ma(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function Na(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function Oa(){var a=Pa,b;for(b in a)return p;return k}var Qa="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");
function Ra(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Qa.length;f++)c=Qa[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};function Sa(a){if(typeof a.ra=="function")a=a.ra();else if(A(a)||C(a))a=a.length;else{var b=0,c;for(c in a)b++;a=b}return a}function Ta(a){if(typeof a.Ha=="function")return a.Ha();if(C(a))return a.split("");if(A(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return Ma(a)}function Ua(a){if(typeof a.yb=="function")return a.yb();if(typeof a.Ha!="function"){if(A(a)||C(a)){for(var b=[],a=a.length,c=0;c<a;c++)b.push(c);return b}return Na(a)}}
function Va(a,b){if(typeof a.forEach=="function")a.forEach(b,j);else if(A(a)||C(a))J(a,b,j);else for(var c=Ua(a),d=Ta(a),e=d.length,f=0;f<e;f++)b.call(j,d[f],c&&c[f],a)}function Wa(a,b){if(typeof a.every=="function")return a.every(b,j);if(A(a)||C(a))return wa(a,b,j);for(var c=Ua(a),d=Ta(a),e=d.length,f=0;f<e;f++)if(!b.call(j,d[f],c&&c[f],a))return p;return k};function Xa(a,b){this.B={};this.A=[];var c=arguments.length;if(c>1){c%2&&h(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.vc(a)}s=Xa.prototype;s.t=0;s.nd=0;s.ra=q("t");s.Ha=function(){Ya(this);for(var a=[],b=0;b<this.A.length;b++)a.push(this.B[this.A[b]]);return a};s.yb=function(){Ya(this);return this.A.concat()};s.ud=function(a){for(var b=0;b<this.A.length;b++){var c=this.A[b];if(Za(this.B,c)&&this.B[c]==a)return k}return p};
s.equals=function(a,b){if(this===a)return k;if(this.t!=a.ra())return p;var c=b||$a;Ya(this);for(var d,e=0;d=this.A[e];e++)if(!c(this.get(d),a.get(d)))return p;return k};function $a(a,b){return a===b}s.clear=function(){this.B={};this.nd=this.t=this.A.length=0};s.remove=function(a){return Za(this.B,a)?(delete this.B[a],this.t--,this.nd++,this.A.length>2*this.t&&Ya(this),k):p};
function Ya(a){if(a.t!=a.A.length){for(var b=0,c=0;b<a.A.length;){var d=a.A[b];Za(a.B,d)&&(a.A[c++]=d);b++}a.A.length=c}if(a.t!=a.A.length){for(var e={},c=b=0;b<a.A.length;)d=a.A[b],Za(e,d)||(a.A[c++]=d,e[d]=1),b++;a.A.length=c}}s.get=function(a,b){return Za(this.B,a)?this.B[a]:b};s.set=function(a,b){Za(this.B,a)||(this.t++,this.A.push(a),this.nd++);this.B[a]=b};s.vc=function(a){var b;a instanceof Xa?(b=a.yb(),a=a.Ha()):(b=Na(a),a=Ma(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])};s.hb=function(){return new Xa(this)};
function Za(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function ab(a){this.B=new Xa;a&&this.vc(a)}function bb(a){var b=typeof a;return b=="object"&&a||b=="function"?"o"+D(a):b.substr(0,1)+a}s=ab.prototype;s.ra=function(){return this.B.ra()};s.add=function(a){this.B.set(bb(a),a)};s.vc=function(a){for(var a=Ta(a),b=a.length,c=0;c<b;c++)this.add(a[c])};s.remove=function(a){return this.B.remove(bb(a))};s.clear=function(){this.B.clear()};s.contains=function(a){a=bb(a);return Za(this.B.B,a)};s.Ha=function(){return this.B.Ha()};s.hb=function(){return new ab(this)};
s.equals=function(a){return this.ra()==Sa(a)&&cb(this,a)};function cb(a,b){var c=Sa(b);if(a.ra()>c)return p;!(b instanceof ab)&&c>5&&(b=new ab(b));return Wa(a,function(a){if(typeof b.contains=="function")a=b.contains(a);else if(typeof b.ud=="function")a=b.ud(a);else if(A(b)||C(b))a=ua(b,a)>=0;else a:{for(var c in b)if(b[c]==a){a=k;break a}a=p}return a})};var db,eb,fb,gb,hb;function ib(){return v.navigator?v.navigator.userAgent:n}gb=fb=eb=db=p;var jb;if(jb=ib()){var kb=v.navigator;db=jb.indexOf("Opera")==0;eb=!db&&jb.indexOf("MSIE")!=-1;fb=!db&&jb.indexOf("WebKit")!=-1;gb=!db&&!fb&&kb.product=="Gecko"}var lb=db,O=eb,mb=gb,nb=fb,ob,pb=v.navigator;ob=pb&&pb.platform||"";hb=ob.indexOf("Mac")!=-1;var qb=ob.indexOf("Win")!=-1,rb;
a:{var sb="",tb;if(lb&&v.opera)var ub=v.opera.version,sb=typeof ub=="function"?ub():ub;else if(mb?tb=/rv\:([^\);]+)(\)|;)/:O?tb=/MSIE\s+([^\);]+)(\)|;)/:nb&&(tb=/WebKit\/(\S+)/),tb)var vb=tb.exec(ib()),sb=vb?vb[1]:"";if(O){var wb,yb=v.document;wb=yb?yb.documentMode:j;if(wb>parseFloat(sb)){rb=""+wb;break a}}rb=sb}var zb={};function Ab(a){return zb[a]||(zb[a]=ta(rb,a)>=0)}var Bb={};function Cb(){return Bb[9]||(Bb[9]=O&&document.documentMode&&document.documentMode>=9)};var Db=!O||Cb();!mb&&!O||O&&Cb()||mb&&Ab("1.9.1");O&&Ab("9");function Eb(a,b){var c;c=(c=a.className)&&typeof c.split=="function"?c.split(/\s+/):[];var d=Aa(arguments,1),e;e=c;for(var f=0,g=0;g<d.length;g++)ua(e,d[g])>=0||(e.push(d[g]),f++);e=f==d.length;a.className=c.join(" ");return e};function Fb(a,b){this.width=a;this.height=b}function Gb(a,b){return a==b?k:!a||!b?p:a.width==b.width&&a.height==b.height}s=Fb.prototype;s.hb=function(){return new Fb(this.width,this.height)};s.gb=function(){return this.width/this.height};s.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};s.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};
s.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};s.scale=function(a){this.width*=a;this.height*=a;return this};function Hb(){var a=document;return a.querySelectorAll&&a.querySelector&&(!nb||document.compatMode=="CSS1Compat"||Ab("528"))?a.querySelectorAll("HEAD"):a.getElementsByTagName("HEAD")}function Ib(a,b){La(b,function(b,d){d=="style"?a.style.cssText=b:d=="class"?a.className=b:d=="for"?a.htmlFor=b:d in Jb?a.setAttribute(Jb[d],b):d.lastIndexOf("aria-",0)==0?a.setAttribute(d,b):a[d]=b})}
var Jb={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};
function P(a,b,c){var d=arguments,e=document,f=d[0],g=d[1];if(!Db&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',ma(g.name),'"');if(g.type){f.push(' type="',ma(g.type),'"');var i={};Ra(i,g);g=i;delete g.type}f.push(">");f=f.join("")}f=e.createElement(f);if(g)C(g)?f.className=g:da(g)?Eb.apply(n,[f].concat(g)):Ib(f,g);d.length>2&&Kb(e,f,d,2);return f}
function Kb(a,b,c,d){function e(c){c&&b.appendChild(C(c)?a.createTextNode(c):c)}for(;d<c.length;d++){var f=c[d];A(f)&&!(ga(f)&&f.nodeType>0)?J(Lb(f)?za(f):f,e):e(f)}}function Q(a,b){Kb(Mb(a),a,arguments,1)}function Mb(a){return a.nodeType==9?a:a.ownerDocument||a.document}function Lb(a){if(a&&typeof a.length=="number"){if(ga(a))return typeof a.item=="function"||typeof a.item=="string";if(fa(a))return typeof a.item=="function"}return p};var Nb=!O||Cb(),Ob=!O||Cb(),Pb=O&&!Ab("8");function Qb(){}Qb.prototype.Ad=p;Qb.prototype.v=function(){if(!this.Ad)this.Ad=k,this.w()};Qb.prototype.w=function(){this.ye&&Rb.apply(n,this.ye)};function Rb(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];A(d)?Rb.apply(n,d):d&&typeof d.v=="function"&&d.v()}};function R(a,b){this.type=a;this.currentTarget=this.target=b}H(R,Qb);R.prototype.w=function(){delete this.type;delete this.target;delete this.currentTarget};R.prototype.qb=p;R.prototype.Jb=k;R.prototype.preventDefault=function(){this.Jb=p};function Sb(a){Sb[" "](a);return a}Sb[" "]=w;function Tb(a,b){a&&this.zb(a,b)}H(Tb,R);var Ub=[1,4,2];s=Tb.prototype;s.target=n;s.relatedTarget=n;s.offsetX=0;s.offsetY=0;s.clientX=0;s.clientY=0;s.screenX=0;s.screenY=0;s.button=0;s.keyCode=0;s.charCode=0;s.ctrlKey=p;s.altKey=p;s.shiftKey=p;s.metaKey=p;s.lf=p;s.lb=n;
s.zb=function(a,b){var c=this.type=a.type;R.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(mb){var e;a:{try{Sb(d.nodeName);e=k;break a}catch(f){}e=p}e||(d=n)}}else if(c=="mouseover")d=a.fromElement;else if(c=="mouseout")d=a.toElement;this.relatedTarget=d;this.offsetX=a.offsetX!==j?a.offsetX:a.layerX;this.offsetY=a.offsetY!==j?a.offsetY:a.layerY;this.clientX=a.clientX!==j?a.clientX:a.pageX;this.clientY=a.clientY!==j?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||(c=="keypress"?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.lf=hb?a.metaKey:a.ctrlKey;this.state=a.state;this.lb=a;delete this.Jb;delete this.qb};function Vb(a,b){return Nb?a.lb.button==b:a.type=="click"?b==0:!!(a.lb.button&Ub[b])}
s.preventDefault=function(){Tb.ma.preventDefault.call(this);var a=this.lb;if(a.preventDefault)a.preventDefault();else if(a.returnValue=p,Pb)try{if(a.ctrlKey||a.keyCode>=112&&a.keyCode<=123)a.keyCode=-1}catch(b){}};s.w=function(){Tb.ma.w.call(this);this.relatedTarget=this.currentTarget=this.target=this.lb=n};function Wb(){}var Xb=0;s=Wb.prototype;s.key=0;s.sb=p;s.xc=p;s.zb=function(a,b,c,d,e,f){fa(a)?this.Hd=k:a&&a.handleEvent&&fa(a.handleEvent)?this.Hd=p:h(Error("Invalid listener argument"));this.Bb=a;this.$d=b;this.src=c;this.type=d;this.capture=!!e;this.Kc=f;this.xc=p;this.key=++Xb;this.sb=p};s.handleEvent=function(a){return this.Hd?this.Bb.call(this.Kc||this.src,a):this.Bb.handleEvent.call(this.Bb,a)};function S(a,b){this.Kd=b;this.Ra=[];a>this.Kd&&h(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.Ra.push(this.qa?this.qa():{})}H(S,Qb);S.prototype.qa=n;S.prototype.zd=n;function Yb(a){return a.Ra.length?a.Ra.pop():a.qa?a.qa():{}}function Zb(a,b){a.Ra.length<a.Kd?a.Ra.push(b):$b(a,b)}function $b(a,b){if(a.zd)a.zd(b);else if(ga(b))if(fa(b.v))b.v();else for(var c in b)delete b[c]}
S.prototype.w=function(){S.ma.w.call(this);for(var a=this.Ra;a.length;)$b(this,a.pop());delete this.Ra};var ac,bc=(ac="ScriptEngine"in v&&v.ScriptEngine()=="JScript")?v.ScriptEngineMajorVersion()+"."+v.ScriptEngineMinorVersion()+"."+v.ScriptEngineBuildVersion():"0";var cc,dc,ec,fc,gc,hc,ic,jc,kc,lc,mc;
(function(){function a(){return{t:0,ea:0}}function b(){return[]}function c(){var a=Ob?function(b){return g.call(a.src,a.key,b)}:function(b){b=g.call(a.src,a.key,b);if(!b)return b};return a}function d(){return new Wb}function e(){return new Tb}var f=ac&&!(ta(bc,"5.7")>=0),g;hc=function(a){g=a};if(f){cc=function(){return Yb(i)};dc=function(a){Zb(i,a)};ec=function(){return Yb(l)};fc=function(a){Zb(l,a)};gc=function(){return Yb(m)};ic=function(){Zb(m,c())};jc=function(){return Yb(r)};kc=function(a){Zb(r,
a)};lc=function(){return Yb(o)};mc=function(a){Zb(o,a)};var i=new S(0,600);i.qa=a;var l=new S(0,600);l.qa=b;var m=new S(0,600);m.qa=c;var r=new S(0,600);r.qa=d;var o=new S(0,600);o.qa=e}else cc=a,dc=w,ec=b,fc=w,gc=c,ic=w,jc=d,kc=w,lc=e,mc=w})();var nc={},T={},oc={},pc={};
function U(a,b,c,d,e){if(b){if(da(b)){for(var f=0;f<b.length;f++)U(a,b[f],c,d,e);return n}var d=!!d,g=T;b in g||(g[b]=cc());g=g[b];d in g||(g[d]=cc(),g.t++);var g=g[d],i=D(a),l;g.ea++;if(g[i]){l=g[i];for(f=0;f<l.length;f++)if(g=l[f],g.Bb==c&&g.Kc==e){if(g.sb)break;return l[f].key}}else l=g[i]=ec(),g.t++;f=gc();f.src=a;g=jc();g.zb(c,f,a,b,d,e);c=g.key;f.key=c;l.push(g);nc[c]=g;oc[i]||(oc[i]=ec());oc[i].push(g);a.addEventListener?(a==v||!a.wd)&&a.addEventListener(b,f,d):a.attachEvent(b in pc?pc[b]:
pc[b]="on"+b,f);return c}h(Error("Invalid event type"))}function qc(a,b,c,d,e){if(da(b))for(var f=0;f<b.length;f++)qc(a,b[f],c,d,e);else a=U(a,b,c,d,e),nc[a].xc=k}function rc(a,b,c,d,e){if(da(b))for(var f=0;f<b.length;f++)rc(a,b[f],c,d,e);else{d=!!d;a:{f=T;if(b in f&&(f=f[b],d in f&&(f=f[d],a=D(a),f[a]))){a=f[a];break a}a=n}if(a)for(f=0;f<a.length;f++)if(a[f].Bb==c&&a[f].capture==d&&a[f].Kc==e){V(a[f].key);break}}}
function V(a){if(nc[a]){var b=nc[a];if(!b.sb){var c=b.src,d=b.type,e=b.$d,f=b.capture;c.removeEventListener?(c==v||!c.wd)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in pc?pc[d]:pc[d]="on"+d,e);c=D(c);e=T[d][f][c];if(oc[c]){var g=oc[c];xa(g,b);g.length==0&&delete oc[c]}b.sb=k;e.Ud=k;sc(d,f,c,e);delete nc[a]}}}
function sc(a,b,c,d){if(!d.Zb&&d.Ud){for(var e=0,f=0;e<d.length;e++)if(d[e].sb){var g=d[e].$d;g.src=n;ic(g);kc(d[e])}else e!=f&&(d[f]=d[e]),f++;d.length=f;d.Ud=p;f==0&&(fc(d),delete T[a][b][c],T[a][b].t--,T[a][b].t==0&&(dc(T[a][b]),delete T[a][b],T[a].t--),T[a].t==0&&(dc(T[a]),delete T[a]))}}
function tc(a,b){var c,d=0,e=b==n,f=c==n;c=!!c;if(a==n)La(oc,function(a){for(var g=a.length-1;g>=0;g--){var i=a[g];if((e||b==i.type)&&(f||c==i.capture))V(i.key),d++}});else{var g=D(a);if(oc[g])for(var g=oc[g],i=g.length-1;i>=0;i--){var l=g[i];if((e||b==l.type)&&(f||c==l.capture))V(l.key),d++}}}function uc(a,b,c,d,e){var f=1,b=D(b);if(a[b]){a.ea--;a=a[b];a.Zb?a.Zb++:a.Zb=1;try{for(var g=a.length,i=0;i<g;i++){var l=a[i];l&&!l.sb&&(f&=vc(l,e)!==p)}}finally{a.Zb--,sc(c,d,b,a)}}return Boolean(f)}
function vc(a,b){var c=a.handleEvent(b);a.xc&&V(a.key);return c}
hc(function(a,b){if(!nc[a])return k;var c=nc[a],d=c.type,e=T;if(!(d in e))return k;var e=e[d],f,g;if(!Ob){var i;if(!(i=b))a:{i="window.event".split(".");for(var l=v;f=i.shift();)if(z(l[f]))l=l[f];else{i=n;break a}i=l}f=i;i=k in e;l=p in e;if(i){if(f.keyCode<0||f.returnValue!=j)return k;a:{var m=p;if(f.keyCode==0)try{f.keyCode=-1;break a}catch(r){m=k}if(m||f.returnValue==j)f.returnValue=k}}m=lc();m.zb(f,this);f=k;try{if(i){for(var o=ec(),t=m.currentTarget;t;t=t.parentNode)o.push(t);g=e[k];g.ea=g.t;
for(var u=o.length-1;!m.qb&&u>=0&&g.ea;u--)m.currentTarget=o[u],f&=uc(g,o[u],d,k,m);if(l){g=e[p];g.ea=g.t;for(u=0;!m.qb&&u<o.length&&g.ea;u++)m.currentTarget=o[u],f&=uc(g,o[u],d,p,m)}}else f=vc(c,m)}finally{if(o)o.length=0,fc(o);m.v();mc(m)}return f}d=new Tb(b,this);try{f=vc(c,d)}finally{d.v()}return f});function wc(a,b,c){this.x=x(a)?a:0;this.y=x(b)?b:0;this.n=x(c)?c:0}wc.prototype.hb=function(){return new wc(this.x,this.y,this.n)};wc.prototype.Na=function(){return[this.x,this.y,this.n]};function xc(a,b,c){this.x=a;this.y=b;this.n=c}H(xc,wc);s=xc.prototype;s.hb=function(){return new xc(this.x,this.y,this.n)};s.scale=function(a){this.x*=a;this.y*=a;this.n*=a;return this};s.normalize=function(){return this.scale(1/Math.sqrt(this.x*this.x+this.y*this.y+this.n*this.n))};s.add=function(a){this.x+=a.x;this.y+=a.y;this.n+=a.n;return this};s.hd=function(a){this.x-=a.x;this.y-=a.y;this.n-=a.n;return this};s.equals=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y&&this.n==a.n};
function yc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.n-b.n;return Math.sqrt(c*c+d*d+e*e)};function W(a,b){if(a instanceof W)this.j=a.Na();else{var c;if(c=A(a))a:{for(var d=c=0;d<a.length;d++){if(!A(a[d])||c>0&&a[d].length!=c){c=p;break a}for(var e=0;e<a[d].length;e++)if(!ea(a[d][e])){c=p;break a}if(c==0)c=a[d].length}c=c!=0}c?this.j=za(a):a instanceof Fb?this.j=zc(a.height,a.width):ea(a)&&ea(b)&&a>0&&b>0?this.j=zc(a,b):h(Error("Invalid argument(s) for Matrix contructor"))}this.e=new Fb(this.j[0].length,this.j.length)}
function Ac(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new W(b)}function Bc(a,b,c){for(var d=0;d<a.e.height;d++)for(var e=0;e<a.e.width;e++)b.call(c,a.j[d][e],d,e,a)}function Cc(a,b){var c=new W(a.e);Bc(a,function(d,e,f){c.j[e][f]=b.call(j,d,e,f,a)});return c}function zc(a,b){for(var c=[],d=0;d<a;d++){c[d]=[];for(var e=0;e<b;e++)c[d][e]=0}return c}s=W.prototype;
s.add=function(a){Gb(this.e,a.e)||h(Error("Matrix summation is only supported on arrays of equal size"));return Cc(this,function(b,c,d){return b+a.j[c][d]})};function Dc(a,b){a.e.height!=b.e.height&&h(Error("The given matrix has height "+b.e.height+", but  needs to have height "+a.e.height+"."));var c=new W(a.e.height,a.e.width+b.e.width);Bc(a,function(a,b,f){c.j[b][f]=a});Bc(b,function(a,b,f){c.j[b][this.e.width+f]=a},a);return c}
s.equals=function(a,b){if(this.e.width!=a.e.width)return p;if(this.e.height!=a.e.height)return p;for(var c=b||0,d=0;d<this.e.height;d++)for(var e=0;e<this.e.width;e++)if(!(Math.abs(this.j[d][e]-a.j[d][e])<=(c||1.0E-6)))return p;return k};function Ec(a){var b=new W(a.e.width,a.e.height);Bc(a,function(a,d,e){b.j[e][d]=a});return b}function X(a,b,c){return!(b>=0&&b<a.e.height&&c>=0&&c<a.e.width)?n:a.j[b][c]}
function Fc(a,b,c,d){b>=0&&b<a.e.height&&c>=0&&c<a.e.width||h(Error("Index out of bounds when setting matrix value, ("+b+","+c+") in size ("+a.e.height+","+a.e.width+")"));a.j[b][c]=d}s.multiply=function(a){if(a instanceof W)return this.e.width!=a.e.height&&h(Error("Invalid matrices for multiplication. Second matrix should have the same number of rows as the first has columns.")),Gc(this,a);if(ea(a))return Hc(this,a);h(Error("A matrix can only be multiplied by a number or another matrix."))};
s.hd=function(a){Gb(this.e,a.e)||h(Error("Matrix subtraction is only supported on arrays of equal size."));return Cc(this,function(b,c,d){return b-a.j[c][d]})};s.Na=q("j");function Ic(a,b,c,d){var e=new W((c?c:a.e.height-1)-0+1,(d?d:a.e.width-1)-b+1);Bc(e,function(a,c,d){e.j[c][d]=this.j[0+c][b+d]},a);return e}function Gc(a,b){var c=new W(a.e.height,b.e.width);Bc(c,function(a,e,f){for(var g=a=0;g<this.e.width;g++)a+=X(this,e,g)*X(b,g,f);Fc(c,e,f,a)},a);return c}
function Hc(a,b){return Cc(a,function(a){return a*b})};function Jc(a,b,c,d,e,f){if(y(d))return n;a=d.multiply(new W([[a/e*2-1],[1-2*b/f],[c*2-1],[1]]));if(X(a,3,0)==0)return n;a=a.multiply(1/X(a,3,0));return new xc(X(a,0,0),X(a,1,0),X(a,2,0))};function Kc(){}H(Kc,Qb);s=Kc.prototype;s.wd=k;s.bd=n;s.addEventListener=function(a,b,c,d){U(this,a,b,c,d)};s.removeEventListener=function(a,b,c,d){rc(this,a,b,c,d)};
s.dispatchEvent=function(a){var b=a.type||a,c=T;if(b in c){if(C(a))a=new R(a,this);else if(a instanceof R)a.target=a.target||this;else{var d=a,a=new R(b,this);Ra(a,d)}var d=1,e,c=c[b],b=k in c,f;if(b){e=[];for(f=this;f;f=f.bd)e.push(f);f=c[k];f.ea=f.t;for(var g=e.length-1;!a.qb&&g>=0&&f.ea;g--)a.currentTarget=e[g],d&=uc(f,e[g],a.type,k,a)&&a.Jb!=p}if(p in c)if(f=c[p],f.ea=f.t,b)for(g=0;!a.qb&&g<e.length&&f.ea;g++)a.currentTarget=e[g],d&=uc(f,e[g],a.type,p,a)&&a.Jb!=p;else for(e=this;!a.qb&&e&&f.ea;e=
e.bd)a.currentTarget=e,d&=uc(f,e,a.type,p,a)&&a.Jb!=p;a=Boolean(d)}else a=k;return a};s.w=function(){Kc.ma.w.call(this);tc(this);this.bd=n};function Lc(a){var b=x(j),c=new XMLHttpRequest;if(b)c.onreadystatechange=function(){c.readyState==4&&j(c.responseText)};c.open("GET",a,b);c.send(n);return b?"":c.responseText}function Mc(a){a=L(a,2*Math.PI);return a>Math.PI?a-2*Math.PI:a}function Nc(a){var b=document.createElement("style");b.type="text/css";b.styleSheet?b.styleSheet.cssText=a:b.appendChild(document.createTextNode(a));Hb()[0].appendChild(b)};function Oc(a){this.f=a;this.da=this.V=0;this.I=1E7;this.ic=this.ya=this.mb=0}H(Oc,Kc);s=Oc.prototype;s.setPosition=function(a,b){this.V=K(a,-1.57,1.57);this.da=Mc(b);this.dispatchEvent(new Pc(Qc))};function Rc(a,b,c){function d(a){var d=c;c=d*Math.cos(a)-2*b*Math.sin(a);b=d*Math.sin(a)/2+b*Math.cos(a)}d(a.ic);b/=Math.max(Math.abs(Math.cos(a.ya)),0.1);d(a.mb);a.setPosition(a.V+b,a.da+c)}s.getPosition=function(){return[this.V,this.da]};
function Sc(a,b){a.I=K(b,250,1E7);a.dispatchEvent(new Pc(Tc))}function Uc(a){return Vc(a.f,a.f.a.ia/2,a.f.a.ha/2,k)}s.setHeading=aa("mb");s.setTilt=aa("ya");s.getHeading=q("mb");s.getTilt=q("ya");var Qc="poschanged",Tc="altchanged";function Pc(a){R.call(this,a)}H(Pc,R);function Wc(a,b,c,d,e){function f(a,b,c,d){a?a=b:(a=b/Math.max(1,Math.sqrt(c*c+d*d)),a=Math.max(1,Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))));return a}a=a.d;this.o=[];this.ib=[];this.i=[];for(var g=-b/2;g<b/2;++g)for(var i=-c/2;i<c/2;++i){var l=f(e,d,g,i),m=[i+1<c/2&&f(e,d,g,i+1)>l,g+1<b/2&&f(e,d,g+1,i)>l,i-1>-c/2&&f(e,d,g,i-1)>l,g-1>-b/2&&f(e,d,g-1,i)>l];Xc(this,g,i,l,m)}this.sc=a.createBuffer();this.pc=a.createBuffer();this.Fd=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.sc);a.bufferData(a.ARRAY_BUFFER,
new Float32Array(this.o),a.STATIC_DRAW);this.sc.Ja=2;a.bindBuffer(a.ARRAY_BUFFER,this.pc);a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.ib),a.STATIC_DRAW);this.pc.Ja=2;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.Fd);a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.i),a.STATIC_DRAW);this.cf=this.i.length}
function Xc(a,b,c,d,e){for(var f=a.o.length/2,g=0;g<=d;++g)for(var i=0;i<=d;++i)a.o.push(b+i/d,c+g/d),a.ib.push(i/d,1-g/d);var l=[0,0,0,0];if(e[0]){l[0]=a.o.length/2;for(i=0;i<d;++i)a.o.push(b+(i+0.5)/d,c+1),a.ib.push((i+0.5)/d,0)}if(e[1]){l[1]=a.o.length/2;for(g=0;g<d;++g)a.o.push(b+1,c+(g+0.5)/d),a.ib.push(1,1-(g+0.5)/d)}if(e[2]){l[2]=a.o.length/2;for(i=0;i<d;++i)a.o.push(b+(i+0.5)/d,c),a.ib.push((i+0.5)/d,1)}if(e[3]){l[3]=a.o.length/2;for(g=0;g<d;++g)a.o.push(b,c+(g+0.5)/d),a.ib.push(0,1-(g+0.5)/
d)}b=E(function(){},a);c=d+1;for(g=0;g<d;++g)for(i=0;i<d;++i){var m=f+g*c+i;a.i.push(m);var r=g==0&&e[2],o=i==0&&e[3];r&&!o?(a.i.push(l[2]+i),a.i.push(m+c),b(),a.i.push(l[2]+i)):o&&!r?(a.i.push(m+1),a.i.push(l[3]+g),b(),a.i.push(l[3]+g)):o&&r&&(a.i.push(l[2]+i),a.i.push(l[3]+g),b(),a.i.push(l[3]+g),a.i.push(l[2]+i),a.i.push(m+c),b(),a.i.push(l[2]+i));a.i.push(m+1);a.i.push(m+c);b();a.i.push(m+c+1);r=g==d-1&&e[0];o=i==d-1&&e[1];r&&!o?(a.i.push(l[0]+i),a.i.push(m+1),b(),a.i.push(l[0]+i)):o&&!r?(a.i.push(m+
c),a.i.push(l[1]+g),b(),a.i.push(l[1]+g)):r&&o&&(a.i.push(l[0]+i),a.i.push(l[1]+g),b(),a.i.push(l[1]+g),a.i.push(l[0]+i),a.i.push(m+1),b(),a.i.push(l[0]+i));a.i.push(m+c);a.i.push(m+1);b()}};function Yc(){this.K=Ac(4)}Yc.prototype.translate=function(a,b,c){this.K=this.K.multiply(new W([[1,0,0,a],[0,1,0,b],[0,0,1,c],[0,0,0,1]]))};Yc.prototype.scale=function(a,b,c){this.K=this.K.multiply(new W([[a,0,0,0],[0,b,0,0],[0,0,c,0],[0,0,0,1]]))};function Zc(a,b){var c=Math.cos(b),d=Math.sin(b);a.K=a.K.multiply(new W([[c,0,d,0],[0,1,0,0],[-d,0,c,0],[0,0,0,1]]))}function $c(a,b){var c=Math.cos(b),d=Math.sin(b);a.K=a.K.multiply(new W([[1,0,0,0],[0,c,-d,0],[0,d,c,0],[0,0,0,1]]))}
function ad(a,b){var c=Math.cos(b),d=Math.sin(b);a.K=a.K.multiply(new W([[c,-d,0,0],[d,c,0,0],[0,0,1,0],[0,0,0,1]]))};function bd(a,b,c){for(var d=n,e=["webgl","experimental-webgl"],f=0;y(d)&&f<e.length;++f)if(!d)a:{try{var g=a.getContext(e[f],{premultipliedAlpha:p});if(z(g)){d=g;break a}}catch(i){}d=n}y(d)&&(x(c)?c():h(Error("unable to get a valid WebGL context")));d.enable(d.CULL_FACE);d.cullFace(d.BACK);d.clearColor(0,0,0,0);d.clearDepth(1);d.enable(d.DEPTH_TEST);d.depthFunc(d.LEQUAL);d.blendFunc(d.SRC_ALPHA,d.ONE_MINUS_SRC_ALPHA);this.canvas=a;this.Gc=b||n;this.d=d;this.ia=a.width;this.ha=a.height;d.viewport(0,
0,this.ia,this.ha);this.Ob=this.Ea=0;this.Nb=1;this.gb=this.ia/this.ha;this.La=Ac(4);this.O=new Yc;this.Fb=this.Eb=this.La;this.Hc=this.Vb=this.Nc=this.sd=this.Fc=0;U(window,"resize",this.Ib,p,this);this.Qb=n}function cd(a){a.Ea=M(50);a.Ob=1.0E-6;a.Nb=5;a.gb=a.ia/a.ha;dd(a)}function dd(a){var b=1/Math.tan(a.Ea/2);a.La=new W([[b/a.gb,0,0,0],[0,b,0,0],[0,0,0,0],[0,0,-1,0]]);ed(a)}function fd(a,b,c){a.Ob=b;a.Nb=c;ed(a)}
function ed(a){var b=a.Ob-a.Nb;Fc(a.La,2,2,(a.Nb+a.Ob)/b);Fc(a.La,2,3,2*a.Nb*a.Ob/b)}bd.prototype.Ib=function(){this.ia=this.canvas.width=this.canvas.clientWidth;this.ha=this.canvas.height=this.canvas.clientHeight;this.d.viewport(0,0,this.ia,this.ha);this.gb=this.ia/this.ha;dd(this);gd(this.c)};bd.prototype.c=n;
function hd(a){a.Eb=a.La.multiply(a.O.K);var b,c=a.Eb;c.e.width!=c.e.height&&h(Error("An inverse can only be taken on a square matrix."));b=Ac(c.e.height);a:{for(var c=Dc(c,b),d=new W(c),e=0,f=0;f<d.e.height;f++){if(e>=d.e.width)break;for(var g=f;d.j[g][e]==0;)if(g++,g==d.e.height&&(g=f,e++,e==d.e.width)){c=d;break a}var i=c,l=f,m=i.j[g];i.j[g]=i.j[l];i.j[l]=m;g=d.j[f][e];for(i=e;i<d.e.width;i++)d.j[f][i]/=g;for(g=0;g<d.e.height;g++)if(g!=f){l=d.j[g][e];for(i=e;i<d.e.width;i++)d.j[g][i]-=l*d.j[f][i]}e++}c=
d}b=!Ic(c,0,b.e.width-1,b.e.height-1).equals(b)?n:Ic(c,b.e.width);a.Fb=b;return a.Eb}bd.prototype.Yd=w;bd.prototype.Hb="";function id(a,b,c){a=a.d||a;c=a.createShader(c);a.shaderSource(c,b);a.compileShader(c);a.getShaderParameter(c,a.COMPILE_STATUS)?y(c)&&h(Error("Unknown")):h(Error("Shader err: "+a.getShaderInfoLog(c)));return c};function jd(a,b,c){var d;d=this.sa=a.d,a=d;this.ub=b;this.ka=c;this.Z=a.createTexture();kd(this)}jd.prototype.Ib=function(a,b){if(!(this.ub==a&&this.ka==b))this.ub=a,this.ka=b,this.sa.deleteTexture(this.Z),this.Z=this.sa.createTexture(),kd(this)};
function kd(a){var b=a.sa;b.activeTexture(b.TEXTURE0);b.bindTexture(b.TEXTURE_2D,a.Z);b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,1);b.texImage2D(b.TEXTURE_2D,0,b.RGBA,a.ub,a.ka,0,b.RGBA,b.UNSIGNED_BYTE,n);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR_MIPMAP_LINEAR);b.generateMipmap(b.TEXTURE_2D)}jd.prototype.clear=function(){this.sa.deleteTexture(this.Z);this.Z=this.sa.createTexture();kd(this)};function ld(a){return function(){return a}}var md=ld(k),nd=ld(n);function od(a){var b=arguments,c=b.length;return function(){for(var a,e=0;e<c;e++)a=b[e].apply(this,arguments);return a}};function pd(a,b,c,d){this.zoom=a||0;this.x=b||0;this.y=c||0;this.Dc=0;this.Ma=d||0;this.jb=this.m=n;this.state=qd}H(pd,Qb);s=pd.prototype;s.getKey=function(){return this.zoom+"_"+this.x+"_"+this.y};s.setData=aa("jb");s.xd=nd;s.ed=aa("m");function rd(a){return a.jb?a.xd(a.jb):a.m}s.vd=w;s.w=function(){this.m=n;if(this.jb)this.vd(this.jb),this.jb=n};var qd=0;function sd(a,b){this.Xb=a||1;this.Mb=b||td;this.wc=E(this.wf,this);this.Pc=F()}H(sd,Kc);sd.prototype.enabled=p;var td=v.window;s=sd.prototype;s.bb=n;s.wf=function(){if(this.enabled){var a=F()-this.Pc;if(a>0&&a<this.Xb*0.8)this.bb=this.Mb.setTimeout(this.wc,this.Xb-a);else if(this.dispatchEvent(ud),this.enabled)this.bb=this.Mb.setTimeout(this.wc,this.Xb),this.Pc=F()}};s.start=function(){this.enabled=k;if(!this.bb)this.bb=this.Mb.setTimeout(this.wc,this.Xb),this.Pc=F()};
s.stop=function(){this.enabled=p;if(this.bb)this.Mb.clearTimeout(this.bb),this.bb=n};s.w=function(){sd.ma.w.call(this);this.stop();delete this.Mb};var ud="tick";function vd(a){fa(a)||(a&&typeof a.handleEvent=="function"?a=E(a.handleEvent,a):h(Error("Invalid listener argument")));return td.setTimeout(a,20)};function wd(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}wd.prototype.hb=function(){return new wd(this.top,this.right,this.bottom,this.left)};wd.prototype.contains=function(a){return!this||!a?p:a instanceof wd?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};function xd(a){this.name=a;this.ca=0;this.Ac=[];this.Rd=-1.4844222297453324;this.Od=1.4844222297453324;this.Sd=-Math.PI;this.Pd=Math.PI;this.Rb=[];this.opacity=1}s=xd.prototype;s.dd=function(a,b,c,d){this.Rd=M(a);this.Od=M(b);this.Sd=M(c);this.Pd=M(d);this.Rb=[]};
function yd(a,b){if(!z(a.Rb[b])){var c=1<<b,d=Math.floor((a.Sd/(2*Math.PI)+0.5)*c),e=Math.floor((a.Pd/(2*Math.PI)+0.5)*c),f=Math.floor((0.5-zd(a.Od)/(Math.PI*2))*c),c=Math.floor((0.5-zd(a.Rd)/(Math.PI*2))*c);a.Rb[b]=new wd(f,e,c,d)}return a.Rb[b]}s.Sa=ba(0);s.yc=ba(p);s.fd=ba(p);s.Mc=ba(k);function Ad(a){J(a.Ac,function(a){this.ca--;this.Cb(a.xf,a.onload,a.jf)},a);a.Ac=[]}function Bd(a,b,c,d){a.Mc()?a.Cb(b,c,d):(a.Ac.push(new Cd(b,c,d)),a.ca++)}s.Oa=function(){};s.Wb=ba(n);s.ae=w;s.zc=w;
function Dd(a,b,c,d,e){this.te=a;this.ue=b;this.tf=c;this.uf=d;this.Ff=e}function Cd(a,b,c){this.xf=a;this.onload=b;this.jf=c};function Ed(a){this.xa=new Xa;this.Ua=[];this.vf=512;this.td=new sd(2E4);U(this.td,ud,this.ve,p,this);this.td.start();Fd(this,a)}function Fd(a,b){a.fe=F();a.T=b;Va(a.xa,function(a){a.v()});a.xa.clear();a.Ua=[]}s=Ed.prototype;s.T=n;s.fe=0;s.yf=w;s.ve=function(){var a=va(this.xa.Ha(),function(a){return a.state==20||a.state==qd||a.state==-10});for(Ba(a,function(a,b){return a.Ma-b.Ma});this.xa.ra()>this.vf&&a.length>0;){var b=a.shift();b.state==qd&&xa(this.Ua,b);this.xa.remove(b.getKey());b.v()}};
s.Af=function(a){a.Ma<this.fe?(a.state=-10,this.xa.remove(a.getKey()),a.v()):this.yf(a)};function Gd(a){Ba(a.Ua,function(a,b){return a.Ma-b.Ma});for(var b=Math.min(a.Ua.length,5-a.T.ca),c=0;c<b;c++)Bd(a.T,a.Ua.pop(),E(a.Af,a))};function Hd(a,b,c,d){this.U=b;this.Aa=[];this.h=c;this.T=a;this.jd=new Ed(a);this.N=d;this.S=1<<this.N;this.kb=this.h>=this.S;this.va=this.Wa=0;this.buffer=n;this.M=[];Id(this)}function Id(a){a.M=[];for(var b=0;b<a.h;++b)a.M.push(Array(a.h));a.buffer&&a.buffer.clear()}Hd.prototype.disable=function(){this.Aa=[];Id(this);this.buffer=n};Hd.prototype.pa=function(a){this.T=a;Fd(this.jd,a);this.Aa=[];Id(this)};
function Jd(a){a.Aa=[];for(var b=E(function(a,b){var c=(this.kb?this.S:this.h)/2;a+=c;b+=c;this.M[b][a]!==1&&Kd(this,this.Wa+a,this.va+b,d)},a),c=E(function(a,c){for(var d=-c;d<c;++d)b(d,-c),b(d,c-1);for(d=-c;d<c;++d)b(-c,d),b(c-1,d)},a),d=F(),a=Math.min(a.h,a.S)/2;a>0;--a)c(d+a,a)}
function Kd(a,b,c,d){var b=L(b,a.S),c=L(c,a.S),e;a:{e=a.jd;var f=a.N,g=b,i=c,c=f+"_"+g+"_"+i,b=e.xa.get(c);if(z(b))b.state==-10?d-b.Ma>7E3&&(b.v(),b=new pd(f,g,i,d),e.xa.set(c,b),e.Ua.push(b)):b.Ma=d;else{d=b=new pd(f,g,i,d);f=yd(e.T,d.zoom);if(!(d.x>=f.left&&d.x<=f.right&&d.y>=f.top&&d.y<=f.bottom)){e=n;break a}e.xa.set(c,b);e.Ua.push(b)}e=b}!y(e)&&e.state==20&&a.Aa.push(e)};function Ld(a,b,c){function d(b){f.isTexture(g)&&(b.Dc>=3||Bd(a,b,e,d))}function e(c){if(f.isTexture(g)){f.activeTexture(f.TEXTURE0);f.bindTexture(f.TEXTURE_2D,g);try{f.texSubImage2D(f.TEXTURE_2D,0,c.x*l,(i-c.y-1)*l,f.RGBA,f.UNSIGNED_BYTE,rd(c))}catch(m){a.yc()&&(a.fd(b.Hb)||!(c.m&&c.m.src.lastIndexOf(b.Hb,0)==0))?Bd(a,c,e,d):b.Yd()}}}var f=this.sa=b.d,g=f.createTexture();this.Z=g;var i=1<<c,l=a.Ga();f.activeTexture(f.TEXTURE0);f.bindTexture(f.TEXTURE_2D,g);f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,1);
f.texImage2D(f.TEXTURE_2D,0,f.RGBA,l*i,l*i,0,f.RGBA,f.UNSIGNED_BYTE,n);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR);f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR);for(var m=0;m<i;++m)for(var r=0;r<i;++r)Bd(a,new pd(c,m,r),e,d)}H(Ld,Qb);Ld.prototype.w=function(){this.sa.deleteTexture(this.Z)};function Md(a,b,c,d,e,f,g){this.U=b;this.h=c;this.X=e;this.ac=f;this.T=a;var i=a.Ga();this.oa=[];for(var l=0;l<d;++l)this.oa.push(new jd(b,this.h*i,this.h*i));for(this.F=[];e<=f;++e)this.F.push(new Hd(a,b,c,e));for(l=0;l<d;++l)this.F[l].buffer=this.oa[l];this.aa=0;this.Ab=g?n:new Ld(a,b,2)}Md.prototype.pa=function(a){if(!y(this.Ab))this.Ab.v(),this.Ab=new Ld(a,this.U,2);this.T=a;var b=this.h*a.Ga();J(this.oa,function(a){a.Ib(b,b)});J(this.F,function(b){b.pa(a)});Nd(this)};
function Od(a,b,c,d,e,f){for(var f=K(f,a.X,a.ac),g=f-(a.X+a.aa+a.oa.length-1);g>0;){var i=a.F[a.aa].buffer;a.F[a.aa].disable();a.F[++a.aa+a.oa.length-1].buffer=i;g--}for(;g<0&&a.aa>0;)i=a.F[a.aa+a.oa.length-1].buffer,a.F[a.aa+a.oa.length-1].disable(),a.F[--a.aa].buffer=i,g++;for(var g=1<<f,l=p,c=(c/(2*Math.PI)+0.5)*g,b=(0.5-zd(b)/(Math.PI*2))*g,e=(e/(2*Math.PI)+0.5)*g,i=(0.5-zd(d)/(Math.PI*2))*g,d=f-a.X;d>=a.aa;d--){var m=K(c-a.h/2,e-a.h,e),r=K(b-a.h/2,i-a.h,i),o=yd(a.T,a.X+d),m=K(m,o.left,o.right+
1-a.h),r=K(r,o.top,o.bottom+1-a.h),m=L(Math.round(m),g),r=Math.round(r),o=a.F[d],t=r,r=p;if(!o.kb){var u=m-o.Wa,B=t-o.va;Math.abs(u)>o.S/2&&(u=(u-(u==0?0:u<0?-1:1)*o.S)%o.S);o.Wa=m;o.va=t;if(Math.abs(u)>=o.h||Math.abs(B)>=o.h)Id(o),r=k;else{r=u!=0||B!=0;if(u>0)for(m=0;m<o.h;++m)o.M[m].splice(0,u),o.M[m].push.apply(o.M[m],Array(u));if(u<0)for(m=0;m<o.h;++m)o.M[m].splice(o.h+u,-u),o.M[m].unshift.apply(o.M[m],Array(-u));if(B>0)for(m=0;m<B;++m)o.M.shift(),o.M.push(Array(o.h));if(B<0)for(m=0;m<-B;++m)o.M.pop(),
o.M.unshift(Array(o.h))}}Jd(o);l|=r;c/=2;b/=2;e/=2;i/=2}l&&Nd(a);e=1;for(d=a.aa;e>0&&d<=f-a.X;d++){g=e;c=a.F[d];b=0;if(c.Aa.length>0){e=Math.min(c.Aa.length,e>=0?1:0);for(i=0;i<e;i++){m=c;l=c.Aa.pop();if(!y(m.buffer)&&l.zoom==m.N&&(o=l.x-m.Wa,r=l.y-m.va,u=1<<m.N,o=L(o,u),r=L(r,u),!(o<0||o>=m.h||r<0||r>=m.h))){u=m.U.d;t=m.T.Ga();u.bindTexture(u.TEXTURE_2D,m.buffer.Z);B=L(o+m.Wa,m.h)*t;t*=m.h-L(r+m.va,m.h)-1;try{u.texSubImage2D(u.TEXTURE_2D,0,B,t,u.RGBA,u.UNSIGNED_BYTE,rd(l)),m.M[r][o]=1}catch(ha){m.T.yc()&&
(m.T.fd(m.U.Hb)||!(l.m&&l.m.src.lastIndexOf(m.U.Hb,0)==0))?Kd(m,l.x,l.y,l.Ma):m.U.Yd()}}b++}}Gd(c.jd);b>0&&(c.U.d.activeTexture(c.U.d.TEXTURE0),c.U.d.bindTexture(c.U.d.TEXTURE_2D,c.buffer.Z),c.U.d.generateMipmap(c.U.d.TEXTURE_2D));e=g-b}}function Pd(a,b,c){return b>a.ac||b-c<a.X?Array(a.h*a.h):Da(a.F[b-a.X-c].M)}function Qd(a,b,c){return b>a.ac||b-c<a.X?n:a.F[b-a.X-c].buffer.Z}
function Rd(a,b,c){if(b>a.ac)return Array(2*c);for(var d=[],e=b-a.X;e>b-a.X-c;--e)d.push(Math.round(a.F[Math.max(0,e)].Wa),Math.round(a.F[Math.max(0,e)].va));return d}function Nd(a){for(var b=Array(a.oa.length),c=0;c<a.oa.length;c++){var d=a.F[a.aa+c],e=Sd((0.5-d.va/d.S)*2*Math.PI),f=Sd((0.5-(d.va+d.h)/d.S)*2*Math.PI);b[c]=new Dd(d.kb?0:Sd((0.5-(d.va+d.h/2)/d.S)*2*Math.PI),d.kb?0:((d.Wa+d.h/2)/d.S-0.5)*2*Math.PI,d.kb?Math.PI/2:Math.abs(e-f),d.kb?Math.PI:d.h/d.S*2*Math.PI,d.N)}a.T.ae(b)};function Td(a,b,c,d){b=b.d;this.k=a;this.ga=b.getAttribLocation(this.k,"aVertexPosition");this.$a=b.getAttribLocation(this.k,"aTextureCoord");this.af=Y(b,this.k,"uMVPMatrix");this.Se=Y(b,this.k,"uMetaL0A");this.Ve=Y(b,this.k,"uMetaL1A");this.Ye=Y(b,this.k,"uMetaL2A");this.Me=Y(b,this.k,"uOffLA");this.je=Y(b,this.k,"uBufferL0A");this.me=Y(b,this.k,"uBufferL1A");this.pe=Y(b,this.k,"uBufferL2A");this.re=Y(b,this.k,"uBufferLnA");if(c)this.Te=Y(b,this.k,"uMetaL0B"),this.We=Y(b,this.k,"uMetaL1B"),this.Ze=
Y(b,this.k,"uMetaL2B"),this.Ne=Y(b,this.k,"uOffLB"),this.ke=Y(b,this.k,"uBufferL0B"),this.ne=Y(b,this.k,"uBufferL1B"),this.qe=Y(b,this.k,"uBufferL2B"),this.$e=Y(b,this.k,"uMixFactor");if(d)this.xe=Y(b,this.k,"uDegradationT"),this.Ue=Y(b,this.k,"uMetaL0T"),this.Xe=Y(b,this.k,"uMetaL1T"),this.Oe=Y(b,this.k,"uOffLT"),this.le=Y(b,this.k,"uBufferL0T"),this.oe=Y(b,this.k,"uBufferL1T"),this.se=Y(b,this.k,"uBufferLnT");this.zf=Y(b,this.k,"uTileCount");this.ef=Y(b,this.k,"uOffset")}
function Y(a,b,c){a=a.getUniformLocation(b,c);y(a)&&h(Error("Invalid name "+c));return a};var Ud={"earth-fs-overlay.glsl":"precision mediump float;uniform sampler2D uBufferL0A;uniform sampler2D uBufferL1A;uniform sampler2D uBufferL2A;uniform sampler2D uBufferLnA;varying float vFallbackA;varying vec2 vTCA;uniform sampler2D uBufferL0B;uniform sampler2D uBufferL1B;uniform sampler2D uBufferL2B;varying float vFallbackB;varying vec2 vTCB;uniform float uMixFactor;void main(){float fallbackA=floor(vFallbackA+0.5);vec4 colorA;if(fallbackA==0.0){colorA=texture2D(uBufferL0A,vTCA);}else if(fallbackA==1.0){colorA=texture2D(uBufferL1A,vTCA);}else if(fallbackA==2.0){colorA=texture2D(uBufferL2A,vTCA);}else if(fallbackA==-1.0){colorA=texture2D(uBufferLnA,vTCA);}else{discard;}float fallbackB=floor(vFallbackB+0.5);vec4 colorB=vec4(0.0);if(fallbackB==0.0){colorB=texture2D(uBufferL0B,vTCB);}else if(fallbackB==1.0){colorB=texture2D(uBufferL1B,vTCB);}else if(fallbackB==2.0){colorB=texture2D(uBufferL2B,vTCB);}gl_FragColor=mix(colorA,colorB,uMixFactor*colorB.a);}",
"earth-fs.glsl":"precision mediump float;uniform sampler2D uBufferL0A;uniform sampler2D uBufferL1A;uniform sampler2D uBufferL2A;uniform sampler2D uBufferLnA;varying float vFallbackA;varying vec2 vTCA;void main(){float fallback=floor(vFallbackA+0.5);if(fallback==0.0){gl_FragColor=texture2D(uBufferL0A,vTCA);}else if(fallback==1.0){gl_FragColor=texture2D(uBufferL1A,vTCA);}else if(fallback==2.0){gl_FragColor=texture2D(uBufferL2A,vTCA);}else if(fallback==-1.0){gl_FragColor=texture2D(uBufferLnA,vTCA);}else{discard;}}",
"earth-vs-overlay.glsl":"#define BUFF_SIDE 4.0\n#define BUFF_SIZE 16\n#define TERRAIN %TERRAIN_BOOL%\n#define BUFF_SIDE_T %BUFFER_SIDE_T_FLOAT%\n#define BUFF_SIZE_T int(BUFF_SIDE_T*BUFF_SIDE_T)\nprecision highp float;const float PI=3.1415927;const float PI2=6.2831855;const float EARTH_RADIUS=6378137.0;const float TERRAIN_MIN=-10000.0;const float TERRAIN_MAX=12000.0;attribute vec2 aVertexPosition;attribute vec2 aTextureCoord;uniform mat4 uMVPMatrix;uniform float uTileCount;uniform vec2 uOffset;uniform float uMetaL0A[BUFF_SIZE];uniform float uMetaL1A[BUFF_SIZE];uniform float uMetaL2A[BUFF_SIZE];uniform vec2 uOffLA[3];varying float vFallbackA;varying vec2 vTCA;uniform float uMetaL0B[BUFF_SIZE];uniform float uMetaL1B[BUFF_SIZE];uniform float uMetaL2B[BUFF_SIZE];uniform vec2 uOffLB[3];varying float vFallbackB;varying vec2 vTCB;\n#if TERRAIN\nuniform float uMetaL0T[BUFF_SIZE_T];uniform float uMetaL1T[BUFF_SIZE_T];uniform vec2 uOffLT[2];uniform sampler2D uBufferL0T;uniform sampler2D uBufferL1T;uniform sampler2D uBufferLnT;uniform float uDegradationT;bool validateOffsetT(vec2 off){return off.x>=0.0&&off.y>=0.0&&off.x<BUFF_SIDE_T&&off.y<BUFF_SIDE_T;}\n#endif\nbool validateOffset(vec2 off){return off.x>=0.0&&off.y>=0.0&&off.x<BUFF_SIDE&&off.y<BUFF_SIDE;}vec2 modFirst(vec2 x,float y){return vec2(x.x-y*floor(x.x/y),x.y);}void main(){vec2 phi=PI2*(aVertexPosition+uOffset)/uTileCount;vec2 tileCoords=vec2(mod(aVertexPosition.x-aTextureCoord.x+uOffset.x+uTileCount*0.5,uTileCount),-aTextureCoord.y-aVertexPosition.y-uOffset.y+uTileCount*0.5);float elev=0.0;\n#if TERRAIN\nvec2 TCT;float fallbackT=-1.0;float degradationModifier=exp2(uDegradationT);vec2 offT=modFirst(tileCoords/degradationModifier-uOffLT[0],uTileCount/degradationModifier);vec2 rawElev;if(validateOffsetT(offT)&&uMetaL0T[int(floor(offT.y)*BUFF_SIDE_T+offT.x)]==1.0){fallbackT=0.0;}else{offT=modFirst((tileCoords/(2.0*degradationModifier))-uOffLT[1],uTileCount/(2.0*degradationModifier));if(validateOffsetT(offT)&&uMetaL1T[int(floor(offT.y)*BUFF_SIDE_T+offT.x)]==1.0){fallbackT=1.0;}else{TCT=(tileCoords+aTextureCoord)/uTileCount;}}if(fallbackT>=0.0){TCT=(offT+aTextureCoord/(exp2(fallbackT)*degradationModifier)+mod(uOffLT[int(fallbackT)],BUFF_SIDE_T))/BUFF_SIDE_T;}TCT.y=1.0-TCT.y;if(fallbackT==0.0){rawElev=texture2D(uBufferL0T,TCT).rg;}else if(fallbackT==1.0){rawElev=texture2D(uBufferL1T,TCT).rg;}else{rawElev=texture2D(uBufferLnT,TCT).rg;}elev=((TERRAIN_MAX-TERRAIN_MIN)*(rawElev.r+rawElev.g/256.0)-TERRAIN_MAX)/EARTH_RADIUS;\n#endif\nfloat exp_2y=exp(2.0*phi.y);float tanh=((exp_2y-1.0)/(exp_2y+1.0));float cosy=sqrt(1.0-tanh*tanh);vec3 pos=vec3(sin(phi.x)*cosy,tanh,cos(phi.x)*cosy);gl_Position=uMVPMatrix*vec4(pos*(1.0+elev),1.0);if(abs(phi.y)>PI){vFallbackA=-1.0e3;return;}vFallbackA=-1.0;vec2 off=modFirst(tileCoords-uOffLA[0],uTileCount);if(validateOffset(off)&&uMetaL0A[int(floor(off.y)*BUFF_SIDE+off.x)]==1.0){vFallbackA=0.0;}else{off=modFirst((tileCoords/2.0)-uOffLA[1],uTileCount/2.0);if(validateOffset(off)&&uMetaL1A[int(floor(off.y)*BUFF_SIDE+off.x)]==1.0){vFallbackA=1.0;}else{off=modFirst((tileCoords/4.0)-uOffLA[2],uTileCount/4.0);if(validateOffset(off)&&uMetaL2A[int(floor(off.y)*BUFF_SIDE+off.x)]==1.0){vFallbackA=2.0;}}}if(vFallbackA>=0.0){vTCA=(off+aTextureCoord/exp2(vFallbackA)+mod(uOffLA[int(vFallbackA)],BUFF_SIDE))/BUFF_SIDE;}else{vTCA=(tileCoords+aTextureCoord)/uTileCount;}vTCA.y=1.0-vTCA.y;vFallbackB=-1.0;off=modFirst(tileCoords-uOffLB[0],uTileCount);if(validateOffset(off)&&uMetaL0B[int(floor(off.y)*BUFF_SIDE+off.x)]==1.0){vFallbackB=0.0;}else{off=modFirst((tileCoords/2.0)-uOffLB[1],uTileCount/2.0);if(validateOffset(off)&&uMetaL1B[int(floor(off.y)*BUFF_SIDE+off.x)]==1.0){vFallbackB=1.0;}else{off=modFirst((tileCoords/4.0)-uOffLB[2],uTileCount/4.0);if(validateOffset(off)&&uMetaL2B[int(floor(off.y)*BUFF_SIDE+off.x)]==1.0){vFallbackB=2.0;}}}if(vFallbackB>=0.0){vTCB=(off+aTextureCoord/exp2(vFallbackB)+mod(uOffLB[int(vFallbackB)],BUFF_SIDE))/BUFF_SIDE;}else{vTCB=(tileCoords+aTextureCoord)/uTileCount;}vTCB.y=1.0-vTCB.y;}",
"earth-vs.glsl":"#define BUFF_SIDE 8.0\n#define BUFF_SIZE 64\n#define TERRAIN %TERRAIN_BOOL%\n#define BUFF_SIDE_T %BUFFER_SIDE_T_FLOAT%\n#define BUFF_SIZE_T int(BUFF_SIDE_T*BUFF_SIDE_T)\nprecision highp float;const float PI=3.1415927;const float PI2=6.2831855;const float EARTH_RADIUS=6378137.0;const float TERRAIN_MIN=-10000.0;const float TERRAIN_MAX=12000.0;attribute vec2 aVertexPosition;attribute vec2 aTextureCoord;uniform mat4 uMVPMatrix;uniform float uTileCount;uniform vec2 uOffset;uniform float uMetaL0A[BUFF_SIZE];uniform float uMetaL1A[BUFF_SIZE];uniform float uMetaL2A[BUFF_SIZE];uniform vec2 uOffLA[3];varying float vFallbackA;varying vec2 vTCA;\n#if TERRAIN\nuniform float uMetaL0T[BUFF_SIZE_T];uniform float uMetaL1T[BUFF_SIZE_T];uniform vec2 uOffLT[2];uniform sampler2D uBufferL0T;uniform sampler2D uBufferL1T;uniform sampler2D uBufferLnT;uniform float uDegradationT;bool validateOffsetT(vec2 off){return off.x>=0.0&&off.y>=0.0&&off.x<BUFF_SIDE_T&&off.y<BUFF_SIDE_T;}\n#endif\nbool validateOffset(vec2 off){return off.x>=0.0&&off.y>=0.0&&off.x<BUFF_SIDE&&off.y<BUFF_SIDE;}vec2 modFirst(vec2 x,float y){return vec2(x.x-y*floor(x.x/y),x.y);}void main(){vec2 phi=PI2*(aVertexPosition+uOffset)/uTileCount;vec2 tileCoords=vec2(mod(aVertexPosition.x-aTextureCoord.x+uOffset.x+uTileCount*0.5,uTileCount),-aTextureCoord.y-aVertexPosition.y-uOffset.y+uTileCount*0.5);float elev=0.0;\n#if TERRAIN\nvec2 TCT;float fallbackT=-1.0;float degradationModifier=exp2(uDegradationT);vec2 offT=modFirst(tileCoords/degradationModifier-uOffLT[0],uTileCount/degradationModifier);vec2 rawElev;if(validateOffsetT(offT)&&uMetaL0T[int(floor(offT.y)*BUFF_SIDE_T+offT.x)]==1.0){fallbackT=0.0;}else{offT=modFirst((tileCoords/(2.0*degradationModifier))-uOffLT[1],uTileCount/(2.0*degradationModifier));if(validateOffsetT(offT)&&uMetaL1T[int(floor(offT.y)*BUFF_SIDE_T+offT.x)]==1.0){fallbackT=1.0;}else{TCT=(tileCoords+aTextureCoord)/uTileCount;}}if(fallbackT>=0.0){TCT=(offT+aTextureCoord/(exp2(fallbackT)*degradationModifier)+mod(uOffLT[int(fallbackT)],BUFF_SIDE_T))/BUFF_SIDE_T;}TCT.y=1.0-TCT.y;if(fallbackT==0.0){rawElev=texture2D(uBufferL0T,TCT).rg;}else if(fallbackT==1.0){rawElev=texture2D(uBufferL1T,TCT).rg;}else{rawElev=texture2D(uBufferLnT,TCT).rg;}elev=((TERRAIN_MAX-TERRAIN_MIN)*(rawElev.r+rawElev.g/256.0)-TERRAIN_MAX)/EARTH_RADIUS;\n#endif\nfloat exp_2y=exp(2.0*phi.y);float tanh=((exp_2y-1.0)/(exp_2y+1.0));float cosy=sqrt(1.0-tanh*tanh);vec3 pos=vec3(sin(phi.x)*cosy,tanh,cos(phi.x)*cosy);gl_Position=uMVPMatrix*vec4(pos*(1.0+elev),1.0);if(abs(phi.y)>PI){vFallbackA=-1.0e3;return;}vFallbackA=-1.0;vec2 off=modFirst(tileCoords-uOffLA[0],uTileCount);if(validateOffset(off)&&uMetaL0A[int(floor(off.y)*BUFF_SIDE+off.x)]==1.0){vFallbackA=0.0;}else{off=modFirst((tileCoords/2.0)-uOffLA[1],uTileCount/2.0);if(validateOffset(off)&&uMetaL1A[int(floor(off.y)*BUFF_SIDE+off.x)]==1.0){vFallbackA=1.0;}else{off=modFirst((tileCoords/4.0)-uOffLA[2],uTileCount/4.0);if(validateOffset(off)&&uMetaL2A[int(floor(off.y)*BUFF_SIDE+off.x)]==1.0){vFallbackA=2.0;}}}if(vFallbackA>=0.0){vTCA=(off+aTextureCoord/exp2(vFallbackA)+mod(uOffLA[int(vFallbackA)],BUFF_SIDE))/BUFF_SIDE;}else{vTCA=(tileCoords+aTextureCoord)/uTileCount;}vTCA.y=1.0-vTCA.y;}",
"halo-fs.glsl":"precision lowp float;uniform sampler2D uGradient;varying vec2 vCoords;void main(){float distance=vCoords.x*vCoords.x+vCoords.y*vCoords.y;if(distance<0.98){discard;}else{gl_FragColor=texture2D(uGradient,vec2((sqrt(distance)-1.0)/0.1,0.5));}}","halo-vs.glsl":"precision lowp float;attribute vec2 aVertexPosition;uniform mat4 uMVMatrix;uniform mat4 uPMatrix;varying vec2 vCoords;void main(){gl_Position=uPMatrix*(uMVMatrix[3]+uMVMatrix[0]*aVertexPosition.x+uMVMatrix[1]*aVertexPosition.y);gl_Position.z=0.0;vCoords=aVertexPosition;}",
"miniglobe-fs.glsl":"precision lowp float;varying vec2 vTextureCoord;uniform sampler2D uSampler;void main(){gl_FragColor=texture2D(uSampler,vTextureCoord);}","miniglobe-vs.glsl":"precision mediump float;attribute vec3 aVertexPosition;attribute vec2 aTextureCoord;uniform mat4 uMVMatrix;uniform mat4 uPMatrix;uniform float uAspect;varying vec2 vTextureCoord;void main(){gl_Position=uPMatrix*uMVMatrix*vec4(aVertexPosition,1.0);gl_Position.x*=uAspect;gl_Position.z=0.0;vTextureCoord=aTextureCoord;}","polygon-fs.glsl":"precision lowp float;uniform vec4 uColor;void main(){gl_FragColor=uColor;}",
"polygon-vs.glsl":"precision highp float;attribute vec3 aVertexCoords;uniform mat4 uMVPMatrix;void main(){gl_Position=uMVPMatrix*vec4(aVertexCoords,1.0);}"};function Vd(a){return a in Ud?Ud[a]:Lc("../we/shaders/"+a)};function Wd(a){xd.call(this,a);this.cd=""}H(Wd,xd);Wd.prototype.yc=ba(k);Wd.prototype.fd=function(a){var b=this.cd!=a;this.cd=a;return b};Wd.prototype.Cb=function(a,b,c){var d=new Image;d.onload=E(function(){a.state=20;this.ca--;b(a)},this);d.onerror=E(function(){a.Dc++;a.state=-10;this.ca--;c&&c(a)},this);a.state=10;a.ed(d);d.crossOrigin="";var e=this.Jc(a.zoom,a.x,a.y);d.src=this.cd+e;this.ca++};function Xd(a,b,c,d,e,f,g,i){Wd.call(this,a);this.url=b;this.minZoom=c;this.maxZoom=d;this.tileSize=e;this.Ee=f===k;this.gd=g||[];this.copyright=i||""}H(Xd,Wd);s=Xd.prototype;s.Sa=q("minZoom");s.Fa=q("maxZoom");s.Ga=q("tileSize");s.Jc=function(a,b,c){var d=this.url.replace("{z}",a.toFixed(0)),d=d.replace("{x}",b.toFixed(0)),d=d.replace("{y}",(this.Ee?(1<<a)-c-1:c).toFixed(0));this.gd.length>0&&(d=d.replace("{sub}",this.gd[L(b+c+a,this.gd.length)]));return d};
s.Oa=function(a){this.copyright.length>0&&Q(a,this.copyright)};function Yd(a){Xd.call(this,a||"MapQuest OSM","http://otile{sub}.mqcdn.com/tiles/1.0.0/osm/{z}/{x}/{y}.png",0,18,256,p,["1","2","3","4"])}H(Yd,Xd);Yd.prototype.Oa=function(a){Q(a,"Map data \u00a9 ",P("a",{href:"http://www.openstreetmap.org/"},"OpenStreetMap")," contributors, CC-BY-SA",P("br"));Q(a,"Tiles Courtesy of ",P("a",{href:"http://open.mapquest.co.uk/"},"MapQuest")," ",P("img",{src:"http://developer.mapquest.com/content/osm/mq_logo.png",border:0}))};function Zd(a,b){this.a=a.a;this.c=a;this.L=b||new Yd;this.P=new Md(this.L,this.a,8,3,1,19);this.J=this.Pa=n;if(this.Za=p)this.oc=new Xd("Terrain","http://srtm.webglearth.com/srtm/{z}/{x}/{y}.png",0,10,256),this.Ca=new Md(this.oc,this.a,2,3,this.oc.Sa(),this.oc.Fa());this.pa(this.L,k);this.ab=1;this.Uc=[0,0];this.ce=[new Wc(this.a,1,1,1),new Wc(this.a,4,4,16,k),new Wc(this.a,6,6,8,k),new Wc(this.a,8,8,8,k),new Wc(this.a,10,10,8),new Wc(this.a,64,64,this.Za?8:4)];this.Pe=$d(this,p);this.Qe=$d(this,
k);this.N=n;U(this.c.b,Tc,this.Ef,p,this)}function ae(a){for(var b=a.P,c="",d=0;d<b.F.length;++d)c+=d+b.X+":"+b.F[d].Aa.length+" ";b="BufferQueue size: "+c+"; Loading tiles: "+a.L.ca;a.Pa&&(b+=" + "+a.Pa.ca);return b}s=Zd.prototype;
s.pa=function(a,b,c){if(a)a.zc=E(this.c.md,this.c);if(c)if(this.Pa=a)z(this.J)?this.J.pa(a):(this.P=new Md(this.L,this.a,4,3,1,19),this.J=new Md(this.Pa,this.a,4,3,0,15));else{if(z(this.J))this.P=new Md(this.L,this.a,8,3,1,19),this.J=n}else{if(!a)return;this.P.pa(a);this.L=a}b!==k&&(gd(this.c),this.c.md(),this.setZoom(this.getZoom()))};
s.draw=function(){var a=this.a.d;this.ab=1<<this.getZoom();var b=this.c.b.getPosition(),c=Uc(this.c.b)||b;this.Uc[0]=Math.floor(b[1]/(2*Math.PI)*this.ab);this.Uc[1]=K(Math.floor(zd(b[0])/(Math.PI*2)*this.ab),-this.ab/2,this.ab/2);Od(this.P,c[0],c[1],b[0],b[1],Math.floor(this.getZoom()));this.J&&Od(this.J,c[0],c[1],b[0],b[1],Math.floor(this.getZoom()));this.Za&&Od(this.Ca,c[0],c[1],b[0],b[1],Math.floor(this.getZoom())-5);c=Math.floor(this.getZoom());this.ab=1<<c;b=this.J?this.Qe:this.Pe;a.useProgram(b.k);
a.activeTexture(a.TEXTURE0);a.bindTexture(a.TEXTURE_2D,Qd(this.P,c,0));a.uniform1i(b.je,0);a.activeTexture(a.TEXTURE1);a.bindTexture(a.TEXTURE_2D,Qd(this.P,c,1));a.uniform1i(b.me,1);a.activeTexture(a.TEXTURE2);a.bindTexture(a.TEXTURE_2D,Qd(this.P,c,2));a.uniform1i(b.pe,2);a.activeTexture(a.TEXTURE3);a.bindTexture(a.TEXTURE_2D,this.P.Ab.Z);a.uniform1i(b.re,3);a.uniform1fv(b.Se,new Float32Array(Pd(this.P,c,0)));a.uniform1fv(b.Ve,new Float32Array(Pd(this.P,c,1)));a.uniform1fv(b.Ye,new Float32Array(Pd(this.P,
c,2)));a.uniform2fv(b.Me,new Float32Array(Rd(this.P,c,3)));this.J&&(a.activeTexture(a.TEXTURE4),a.bindTexture(a.TEXTURE_2D,Qd(this.J,c,0)),a.uniform1i(b.ke,4),a.activeTexture(a.TEXTURE5),a.bindTexture(a.TEXTURE_2D,Qd(this.J,c,1)),a.uniform1i(b.ne,5),a.activeTexture(a.TEXTURE6),a.bindTexture(a.TEXTURE_2D,Qd(this.J,c,2)),a.uniform1i(b.qe,6),a.uniform1fv(b.Te,new Float32Array(Pd(this.J,c,0))),a.uniform1fv(b.We,new Float32Array(Pd(this.J,c,1))),a.uniform1fv(b.Ze,new Float32Array(Pd(this.J,c,2))),a.uniform2fv(b.Ne,
new Float32Array(Rd(this.J,c,3))),a.uniform1f(b.$e,this.Pa.opacity));if(this.Za){var d=K(c-5,2,this.oc.Fa());a.uniform1f(b.xe,c-d);a.activeTexture(a.TEXTURE7);a.bindTexture(a.TEXTURE_2D,Qd(this.Ca,d,0));a.uniform1i(b.le,7);a.activeTexture(a.TEXTURE8);a.bindTexture(a.TEXTURE_2D,Qd(this.Ca,d,1));a.uniform1i(b.oe,8);a.activeTexture(a.TEXTURE9);a.bindTexture(a.TEXTURE_2D,this.Ca.Ab.Z);a.uniform1i(b.se,9);a.uniform1fv(b.Ue,new Float32Array(Pd(this.Ca,d,0)));a.uniform1fv(b.Xe,new Float32Array(Pd(this.Ca,
d,1)));a.uniform2fv(b.Oe,new Float32Array(Rd(this.Ca,d,2)))}d=new Float32Array(Da(Ec(hd(this.a)).Na()));c=this.ce[Math.min(c,this.ce.length-1)];a.bindBuffer(a.ARRAY_BUFFER,c.sc);a.vertexAttribPointer(b.ga,c.sc.Ja,a.FLOAT,p,0,0);a.enableVertexAttribArray(b.ga);a.bindBuffer(a.ARRAY_BUFFER,c.pc);a.vertexAttribPointer(b.$a,c.pc.Ja,a.FLOAT,p,0,0);a.enableVertexAttribArray(b.$a);a.uniformMatrix4fv(b.af,p,d);a.uniform1f(b.zf,this.ab);a.uniform2fv(b.ef,new Float32Array(this.Uc));a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,
c.Fd);a.drawElements(a.TRIANGLES,c.cf,a.UNSIGNED_SHORT,0);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,n);a.disableVertexAttribArray(b.ga);a.disableVertexAttribArray(b.$a)};
function $d(a,b){var c=a.a.d,d=Vd("earth-fs"+(b?"-overlay":"")+".glsl"),e=Vd("earth-vs"+(b?"-overlay":"")+".glsl"),e=e.replace("%TERRAIN_BOOL%",a.Za?"1":"0");a.Za&&(e=e.replace("%BUFFER_SIDE_T_FLOAT%",a.Ca.h.toFixed(1)));var d=id(a.a,d,c.FRAGMENT_SHADER),e=id(a.a,e,c.VERTEX_SHADER),f=c.createProgram();y(f)&&h(Error("Unknown"));c.attachShader(f,e);c.attachShader(f,d);c.bindAttribLocation(f,0,"aVertexPosition");c.linkProgram(f);c.getProgramParameter(f,c.LINK_STATUS)||h(Error("Shader program err: "+
c.getProgramInfoLog(f)));return new Td(f,a.a,b,a.Za)}s.setZoom=function(a){this.N=K(a,this.L.Sa(),this.L.Fa());Sc(this.c.b,be(this,this.N,this.c.b.V))};s.Ef=function(){this.N=n};s.getZoom=function(){y(this.N)&&ce(this);return this.N};function ce(a,b){var c=a.c.b,d=2*(c.I/6378137)*Math.tan(a.a.Ea/2)/a.c.rc,c=Math.log(Math.cos(Math.abs(c.V))*2*Math.PI/d)/Math.LN2;if(b)return c;a.N=K(c,a.L.Sa(),a.L.Fa());return a.N}
function be(a,b,c){b=Math.cos(Math.abs(c))*2*Math.PI/Math.pow(2,b)*a.c.rc;return 1/Math.tan(a.a.Ea/2)*(b/2)*6378137}function de(a,b,c,d){var e=Math.sin((c-a)/2),b=Math.sin((d-b)/2);return 6378137*2*Math.asin(Math.sqrt(e*e+Math.cos(a)*Math.cos(c)*b*b))};function ee(a){var c;this.a=a.a;c=this.d=a.a.d,a=c;this.$=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.$);a.bufferData(a.ARRAY_BUFFER,new Float32Array([1.1,1.1,-1.1,1.1,1.1,-1.1,-1.1,-1.1]),a.STATIC_DRAW);this.Dd=a.createTexture();var b=new Uint8Array([224,224,255,255,207,218,250,220,179,194,245,180,137,166,237,145,84,123,221,110,51,94,198,75,25,67,178,30,13,53,161,0]);a.activeTexture(a.TEXTURE0);a.bindTexture(a.TEXTURE_2D,this.Dd);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,8,1,0,a.RGBA,a.UNSIGNED_BYTE,
b);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);b=Vd("halo-fs.glsl");a=Vd("halo-vs.glsl");b=id(this.a,b,this.d.FRAGMENT_SHADER);a=id(this.a,a,this.d.VERTEX_SHADER);this.g=this.d.createProgram();y(this.g)&&h(Error("Unknown"));this.d.attachShader(this.g,a);this.d.attachShader(this.g,b);this.d.bindAttribLocation(this.g,
0,"aVertexPosition");this.d.linkProgram(this.g);this.d.getProgramParameter(this.g,this.d.LINK_STATUS)||h(Error("Shader program err: "+this.d.getProgramInfoLog(this.g)));this.ga=this.d.getAttribLocation(this.g,"aVertexPosition");this.Sc=this.d.getUniformLocation(this.g,"uMVMatrix");this.$c=this.d.getUniformLocation(this.g,"uPMatrix");this.He=this.d.getUniformLocation(this.g,"uGradient")}
ee.prototype.draw=function(){this.d.useProgram(this.g);this.d.activeTexture(this.d.TEXTURE0);this.d.bindTexture(this.d.TEXTURE_2D,this.Dd);this.d.uniform1i(this.He,0);var a=new Float32Array(Da(Ec(this.a.O.K).Na())),b=new Float32Array(Da(Ec(this.a.La).Na()));this.d.uniformMatrix4fv(this.Sc,p,a);this.d.uniformMatrix4fv(this.$c,p,b);this.d.bindBuffer(this.d.ARRAY_BUFFER,this.$);this.d.bindBuffer(this.d.ELEMENT_ARRAY_BUFFER,n);this.d.vertexAttribPointer(this.ga,2,this.d.FLOAT,p,0,0);this.d.enableVertexAttribArray(this.ga);
this.d.drawArrays(this.d.TRIANGLE_STRIP,0,4);this.d.disableVertexAttribArray(this.ga)};function fe(a,b,c,d){this.f=a;this.canvas=document.createElement("canvas");Q(this.f.a.canvas.parentElement||window.document,this.canvas);var a={depth:p},e=this.d=this.canvas.getContext("webgl",a)||this.canvas.getContext("experimental-webgl",a);e.enable(e.CULL_FACE);e.cullFace(e.BACK);e.clearColor(0,0,0,0);this.$=e.createBuffer();for(var a=[],f=[],g=[],i=0;i<=b;i++)for(var l=i*Math.PI/b,m=Math.sin(l),r=Math.cos(l),l=0;l<=c;l++){var o=l*2*Math.PI/c;o-=Math.PI/2;var t=Math.cos(o)*m,u=r,o=Math.sin(o)*
m,B=1-i/b;f.push(1-l/c);f.push(B);a.push(1*t);a.push(1*u);a.push(1*o)}for(i=0;i<b;i++)for(l=0;l<c;l++)m=i*(c+1)+l,r=m+c+1,g.push(m+1),g.push(r),g.push(m),g.push(m+1),g.push(r+1),g.push(r);this.$=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,this.$);e.bufferData(e.ARRAY_BUFFER,new Float32Array(a),e.STATIC_DRAW);this.$.Ja=3;this.$.Tc=a.length/3;this.Lb=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,this.Lb);e.bufferData(e.ARRAY_BUFFER,new Float32Array(f),e.STATIC_DRAW);this.Lb.Ja=2;this.Lb.Tc=f.length/
2;this.Ia=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.Ia);e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(g),e.STATIC_DRAW);this.Ia.Ja=1;this.Ia.Tc=g.length;this.qc=n;var ha=new Image;ha.onload=E(function(){this.qc=e.createTexture();e.activeTexture(e.TEXTURE0);e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,k);e.bindTexture(e.TEXTURE_2D,this.qc);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,ha);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR);e.texParameteri(e.TEXTURE_2D,
e.TEXTURE_MIN_FILTER,e.LINEAR)},this);ha.src=d;c=Vd("miniglobe-fs.glsl");b=Vd("miniglobe-vs.glsl");c=id(e,c,e.FRAGMENT_SHADER);b=id(e,b,e.VERTEX_SHADER);this.g=e.createProgram();y(this.g)&&h(Error("Unknown"));e.attachShader(this.g,b);e.attachShader(this.g,c);e.bindAttribLocation(this.g,0,"aVertexPosition");e.linkProgram(this.g);e.getProgramParameter(this.g,e.LINK_STATUS)||h(Error("Shader program err: "+e.getProgramInfoLog(this.g)));e.useProgram(this.g);this.ga=e.getAttribLocation(this.g,"aVertexPosition");
this.$a=e.getAttribLocation(this.g,"aTextureCoord");this.ie=e.getUniformLocation(this.g,"uAspect");this.$c=e.getUniformLocation(this.g,"uPMatrix");this.Sc=e.getUniformLocation(this.g,"uMVMatrix");this.nf=e.getUniformLocation(this.g,"uSampler");this.e=128;this.ad=0.1}function Ka(a,b){var c=a.e*(1+a.ad);b.drawImage(a.canvas,a.f.a.canvas.width-c,a.f.a.canvas.height-c)}
fe.prototype.draw=function(){if(z(this.qc)){var a=this.d;a.useProgram(this.g);a.activeTexture(a.TEXTURE0);a.bindTexture(a.TEXTURE_2D,this.qc);a.uniform1i(this.nf,0);var b=new Yc;b.translate(0,0,-1.1/Math.tan(this.f.a.Ea/2));$c(b,this.f.b.V);Zc(b,-this.f.b.da);var c=new Float32Array(Da(Ec(this.f.a.La).Na()));a.uniformMatrix4fv(this.Sc,p,new Float32Array(Da(Ec(b.K).Na())));a.uniformMatrix4fv(this.$c,p,c);a.uniform1f(this.ie,this.f.a.gb);a.bindBuffer(a.ARRAY_BUFFER,this.$);a.vertexAttribPointer(this.ga,
this.$.Ja,a.FLOAT,p,0,0);a.bindBuffer(a.ARRAY_BUFFER,this.Lb);a.vertexAttribPointer(this.$a,this.Lb.Ja,a.FLOAT,p,0,0);a.enableVertexAttribArray(this.ga);a.enableVertexAttribArray(this.$a);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.Ia);a.drawElements(a.TRIANGLES,this.Ia.Tc,a.UNSIGNED_SHORT,0);a.disableVertexAttribArray(this.ga);a.disableVertexAttribArray(this.$a)}};function ge(a,b,c,d,e,f,g){this.a=a;this.Gd=b||n;this.na=c||document.createElement("div");if(!x(c))a=this.a.canvas,a.parentNode&&a.parentNode.insertBefore(this.na,a.nextSibling);this.tb=d||document.createElement("img");if(!x(d))d=this.na,d.parentNode&&d.parentNode.insertBefore(this.tb,d.nextSibling);this.he=f||n;this.b=new Oc(this);this.z=new Zd(this,e);this.ob=n;this.Ed=g===k?n:new ee(this);this.qd=[];this.rc=0;gd(this);this.md()}
ge.prototype.md=function(){if(!y(this.na)){for(var a=this.na,b;b=a.firstChild;)a.removeChild(b);Q(this.na,this.he);this.z.L.Oa(this.na);this.z.Pa&&(Q(this.na,P("br"),P("strong",{},"Overlay data:"),P("br")),this.z.Pa.Oa(this.na));this.na.style.Zd="none";a=this.na.getElementsByTagName("a");for(b=0;b<a.length;++b)a[b].style.Zd="auto"}if(!y(this.tb))y(this.z.L.Wb())?this.tb.style.visibility="hidden":(this.tb.src=this.z.L.Wb(),this.tb.style.visibility="visible"),this.tb.style.Zd="none"};
function gd(a){a.rc=0.7*a.a.canvas.height/a.z.L.Ga()}
ge.prototype.draw=function(){var a=this.a.d;if(!y(this.Gd))this.Gd.innerHTML=N(this.b.V).toFixed(4)+"; "+N(this.b.da).toFixed(4)+" @ "+this.b.I.toFixed(0)+"m -> z="+this.z.getZoom().toFixed(3)+"; "+ae(this.z);var b=this.b.I/6378137;fd(this.a,0.25*b,1+b);if(this.Ed){a.enable(a.BLEND);a.disable(a.DEPTH_TEST);var b=Math.sin((Math.PI-this.a.Ea)/2),c=Math.sin(this.a.Ea/2);this.a.O.K=Ac(4);$c(this.a.O,-this.b.getTilt());this.a.O.translate(0,0,c-1-this.b.I/6378137);this.a.O.scale(b,b,b);this.Ed.draw();a.disable(a.BLEND);
a.enable(a.DEPTH_TEST)}this.a.O.K=Ac(4);ad(this.a.O,-this.b.ic);$c(this.a.O,-this.b.getTilt());ad(this.a.O,-this.b.getHeading());this.a.O.translate(0,0,-1-this.b.I/6378137);$c(this.a.O,this.b.V);Zc(this.a.O,-this.b.da);this.z.draw();J(this.qd,function(a){a.draw()});this.ob&&this.ob.draw()};
function he(a,b){var c=a.hb();c.x=-c.x;c.y=-c.y;c.n=-c.n;var d=b.x*c.x+b.y*c.y+b.n*c.n,e=d*d-(c.x*c.x+c.y*c.y+c.n*c.n)+1;if(e<0)return n;c=Math.min(d+Math.sqrt(e),d-Math.sqrt(e));d=Math.max(d+Math.sqrt(e),d-Math.sqrt(e));return[c,d]}
function Vc(a,b,c,d){var e=Jc(b,c,0,a.a.Fb,a.a.ia,a.a.ha),a=Jc(b,c,1,a.a.Fb,a.a.ia,a.a.ha);if(y(e)||y(a))return n;a.hd(e);a.normalize();b=he(e,a);if(y(b))return n;a=a.scale(b[0]);e=new xc(e.x+a.x,e.y+a.y,e.n+a.n);a=Math.asin(e.x/Math.sqrt(1-e.y*e.y));e.n<0&&(a=Math.PI-a);return d==k?[Math.asin(e.y),Mc(a)]:[N(Math.asin(e.y)),N(Mc(a))]}function zd(a){return Math.log(Math.tan(a/2+Math.PI/4))}function Sd(a){return 2*Math.atan(Math.exp(a))-Math.PI/2};function ie(a,b,c){var d=P("div",{"class":"we-pp-content"});d.innerHTML=a;a=P("div",{"class":"we-pp-wrapper"},d);d=P("div",{"class":"we-pp-tip-cont"},P("div",{"class":"we-pp-tip"}));this.D=P("div",{"class":"we-pp"});if(c!==p)c=P("a",{"class":"we-pp-close",href:"#"}),c.onclick=E(this.show,this,p),this.D.appendChild(c);this.D.appendChild(a);this.D.appendChild(d);b=b||300;this.D.style.width=b.toFixed(0)+"px";this.D.style.left=(-b/2).toFixed(0)+"px";this.show(p)}
ie.prototype.show=function(a){a?(this.D.style.opacity=1,this.D.style.visibility="visible"):(this.D.style.opacity=0,this.D.style.visibility="hidden")};Nc('.we-pp-content p{margin:18px 0;text-align:justify;}.we-pp-wrapper{padding:1px;text-align:left;border-radius:20px;}.we-pp{z-index:100;-webkit-transition:opacity 0.2s linear;-moz-transition:opacity 0.2s linear;-o-transition:opacity 0.2s linear;transition:opacity 0.2s linear;position:absolute;}.we-pp-wrapper,.we-pp-tip{background:white;box-shadow:0 1px 10px #888;-moz-box-shadow:0 1px 10px #888;-webkit-box-shadow:0 1px 14px #999;}.we-pp-close{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAMAAAC67D+PAAAAk1BMVEX////Ny8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8vNy8sw0horAAAAMHRSTlMA/bGBFK1LgjellwUx2+VZo73SE6z5fQYOtzLRpxI22CC4g6ieV+yAEc8/ZocEHTzU+GNbAAAAV0lEQVQI1wXBBQKDMADAwLRl7szdgCks/3/d7hh0ehl0W21IwZgNR44nTNVZribmC1WXqzVstmpIALu9Gg5HOJ1VNV64arjd1YKy8sEz+nrD51tD0//xB/w6CnrIHetcAAAAAElFTkSuQmCC);position:absolute;top:9px;right:9px;width:10px;height:10px;overflow:hidden;}.we-pp-content{display:inline-block;margin:19px;font:12px/1.4 "Helvetica Neue",Arial,Helvetica,sans-serif;}.we-pp-tip-cont{margin:0 auto;width:40px;height:16px;position:relative;overflow:hidden;}.we-pp-tip{width:15px;height:15px;padding:1px;margin:-8px auto 0;-moz-transform:rotate(45deg);-webkit-transform:rotate(45deg);-o-transform:rotate(45deg);transform:rotate(45deg);}');function je(a,b,c){this.lat=a;this.W=b;this.element=c;this.parentElement=n;this.enabled=k;this.visible=p}s=je.prototype;s.detach=function(){if(this.parentElement){var a=this.element;a&&a.parentNode&&a.parentNode.removeChild(a);this.parentElement=n}};s.enable=function(a){(this.enabled=a||p)||this.show(p)};s.isEnabled=q("enabled");s.show=function(a){this.visible=a==k;this.element.style.display=this.visible?"block":"none"};
s.lc=function(a,b){this.element.style.left=a.toFixed()+"px";this.element.style.top=b.toFixed()+"px";this.enabled&&this.show(k)};s.Bd=w;function ke(a,b,c,d,e){var f=P("div",{"class":"we-pm-icon"});if(C(c))f.style.backgroundImage="url("+c+")";this.ub=d||25;this.ka=e||41;f.style.width=this.ub.toFixed(0)+"px";f.style.height=this.ka.toFixed(0)+"px";f.style.marginLeft=(-this.ub/2).toFixed(0)+"px";f.style.marginTop=(-this.ka).toFixed(0)+"px";c=P("div",{style:"position:absolute;"},f);je.call(this,a,b,c);this.D=n;this.show(p);this.mc(p);f.onclick=E(this.mc,this,k)}H(ke,je);ke.prototype.mc=function(a){this.D&&this.D.show(a)};Nc(".we-pm-icon{position:absolute;z-index:64;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFtklEQVR42p3Wa0xTZxgH8CYkS5aQLGFxcXNZNNu4FIFCK9eCWOQm3lDizLYP+zTnxLk5wQpICxRaLuWi3FpQFMU55xDkjiBTFMeA9Zy2JzMxWUZisoS4TyRuQvG/pydQKb3Q2uSXw3nf93n+5z2nLRVIiga88RERL/MlAgDrosJ+d/zISTJMEFt2B9LyEV5kySBo7G+iI9vdhyj7nfEhcjKfUvcAma0z+Pwa5+BwuxG7myaRUH4XtHaAhLgI6VvLjwwn14zj0CUWn13lkHXZhPQWBml6e3svGq3zvIyGX0F1z0mWQ4hY0buaH3mcUvsAn17hcKDNhFQdsy4K5Nfv108jsXIM1OOoqxAfMppMAYepIF3PIrmZ8cqhy2ZkXjBYQyxE9iqksGeFXKa9h0PtHF0di6Qmxhk+fKeLOcLX72r8DdRvjvjxIRGFt638yPz+Vha7W0zY0cDYydAbkXWJ4+1rYWx/H2gzO6wl/JysehzUUw0+5Oxtq+zEyns42MYhsZ6xQ2N0C0yQae9DouhFZt1dOvYgnt5RGU3T/Dw1tqtJ1xn5Gur7D/ERRBR0W43vapzhd5FwnrHZ02Kmt+jvkBTeRsOdPzD/7wJWXkPGp0hSD2BnzUMcuMjZ1RF+LFY1BOotFYQXdPkSy/5WDvF1DKSr8GOau7g1/RecvWafzSOuuBf79CYkNxodandox0G9VYLw/FvCSGUf9rZQci1js6PeiPRGAw7WjTgNePnyJa9mgJ5h1QPsWVOf0kTBdZOg/p0CUV6nNKp4ALv1HKJrGJu0Znqo1RNQds64DLBYLBjjniK6ZMihXtZgRPK5KVD/UYHozM+R1p1k6DhEaRmblAYK0U4g/8aUy4DFxUUMMLOIUQ071CfVm5BUOwnq30shNzeJC7qwq5nDtirGJq6GRWoDixR1HxYsS3YhS0tLWFhY4OVdf4TEqgmkNprt6ukiafwhqL9OECb/yYfMpzaaEKllIa5kbNKa6D6XjqK632i3C9oBH3DPPIttyn5+XUy1Y22cegzUO18QdvqGVWdC5SNK5xBezqyg3dB9pW1Hl4wgu20cM3/O4b+FRTx++gwNgywkeTfhrE5cwfBj4oJuUG+hIDT3RyuZpLAXO+s5hGkYOzHVRn5cWv4Q4rM91iJE5HchpnQMsjrWWY1tPfUd5j/xoTnXV0zEV05Cds6MUDVjR6RhkXSecxBTbXJYG0ZojnbRA+opXQ75YUWmpLCfro7D1lLmdfH1Us0EqN+o7Vs45NS1FT7kSXzVDGK1ZghVzGtJpJAI2gX1Sn4V8n3HakcliiEk1HIILGG8FldtRqxmEtRn2u6f1taTHau9SebitCzCNUb4FzNekdZwCC/oA/XIsg/57upaKrFiBHFaDh8rGY9FVZgRrZ4C1T8mPnYhwd9eWWsDeR5TaUKwyogPFYxHYqo4iPL7QbVf8M3tQ9qd0UUoxhBdyWFLIbOucLUJkeoZUN0secMx5MRlZwKIhW4BXSWLzWcZt6IqrLsYBNWccPq7S/jNJVe6wxX3sU1jxgf5BpeExUZIygyg9XPE13nI8TZXtm89dRNiCnk/z+AKPx+aNwhaX+jyZ2pQ9kV3JkTKRxCVmrDpjMGBv4JFRBkLWjdP3nITcsGdT4JzuiAqM+NduWEtfjzkzBBoXQXf0GXIsVZ3fMiTsKIpBBYZsfG0wWZzAQuRygSaf0E2ug0J/LplPdnBOT0IVZnxTq5hBX8eLB8Gzev4Zu5D9OvxJXMhRQZsoavfkEPPQ84gpMQEGreQLeuGBBzVe0IVlDuA4GIz3j5l4I9B8hHQeIfbAFvIVzpPbCQvhEoT3pOzEBaZEZh9BTQW4mFIs6d0gbl3EKSkAPkY6LyXCDwLOdLsKWHAsXYEKswIOH4NdC4lnoX4H2nyRnfA6THQ8Zflcw9Dvmz0xnb/7A7QMW353OMQb7USgTch/wNGSWfRl/HE1wAAAABJRU5ErkJggg==);}");function le(){this.l=Z;this.Da=this.startTime=n}H(le,Kc);var Z=0;function me(a){a.u("end")}le.prototype.u=function(a){this.dispatchEvent(a)};var Pa={},ne=n;function oe(a){a=D(a);delete Pa[a];Oa()&&ne&&(td.clearTimeout(ne),ne=n)}function pe(){ne||(ne=vd(function(){ne=n;qe()}))}function qe(){var a=F();La(Pa,function(b){re(b,a)});Oa()||pe()};function se(a,b,c,d){le.call(this);(!da(a)||!da(b))&&h(Error("Start and end parameters must be arrays"));a.length!=b.length&&h(Error("Start and end points must be the same length"));this.Kb=a;this.Be=b;this.duration=c;this.pd=d;this.coords=[]}H(se,le);s=se.prototype;s.Cd=0;s.Y=0;s.Oc=n;
s.play=function(a){if(a||this.l==Z)this.Y=0,this.coords=this.Kb;else if(this.l==1)return p;oe(this);this.startTime=a=F();this.l==-1&&(this.startTime-=this.duration*this.Y);this.Da=this.startTime+this.duration;this.Oc=this.startTime;this.Y||this.u("begin");this.u("play");this.l==-1&&this.u("resume");this.l=1;var b=D(this);b in Pa||(Pa[b]=this);pe();re(this,a);return k};s.stop=function(a){oe(this);this.l=Z;if(a)this.Y=1;te(this,this.Y);this.u("stop");me(this)};
s.w=function(){this.l==Z||this.stop(p);this.u("destroy");se.ma.w.call(this)};function re(a,b){a.Y=(b-a.startTime)/(a.Da-a.startTime);if(a.Y>=1)a.Y=1;a.Cd=1E3/(b-a.Oc);a.Oc=b;te(a,a.Y);a.Y==1?(a.l=Z,oe(a),a.u("finish"),me(a)):a.l==1&&a.u("animate")}function te(a,b){fa(a.pd)&&(b=a.pd(b));a.coords=Array(a.Kb.length);for(var c=0;c<a.Kb.length;c++)a.coords[c]=(a.Be[c]-a.Kb[c])*b+a.Kb[c]}s.u=function(a){this.dispatchEvent(new ue(a,this))};
function ue(a,b){R.call(this,a);this.coords=b.coords;this.x=b.coords[0];this.y=b.coords[1];this.n=b.coords[2];this.duration=b.duration;this.Y=b.Y;this.Fc=b.Cd;this.state=b.l;this.Hf=b}H(ue,R);function ve(){le.call(this);this.s=[]}H(ve,le);ve.prototype.add=function(a){ua(this.s,a)>=0||(this.s.push(a),U(a,"finish",this.Vc,p,this))};ve.prototype.remove=function(a){xa(this.s,a)&&rc(a,"finish",this.Vc,p,this)};ve.prototype.w=function(){J(this.s,function(a){a.v()});this.s.length=0;ve.ma.w.call(this)};function we(){ve.call(this);this.Ec=0}H(we,ve);
we.prototype.play=function(a){if(this.s.length==0)return p;if(a||this.l==Z)this.Ec=0,this.u("begin");else if(this.l==1)return p;this.u("play");this.l==-1&&this.u("resume");var b=this.l==-1&&!a;this.startTime=F();this.Da=n;this.l=1;J(this.s,function(c){(!b||c.l==-1)&&c.play(a)});return k};we.prototype.stop=function(a){J(this.s,function(b){b.l==Z||b.stop(a)});this.l=Z;this.Da=F();this.u("stop");me(this)};
we.prototype.Vc=function(){this.Ec++;if(this.Ec==this.s.length)this.Da=F(),this.l=Z,this.u("finish"),me(this)};function xe(){ve.call(this);this.ba=0}H(xe,ve);xe.prototype.play=function(a){if(this.s.length==0)return p;if(a||this.l==Z)this.ba<this.s.length&&this.s[this.ba].l!=Z&&this.s[this.ba].stop(p),this.ba=0,this.u("begin");else if(this.l==1)return p;this.u("play");this.l==-1&&this.u("resume");this.startTime=F();this.Da=n;this.l=1;this.s[this.ba].play(a);return k};
xe.prototype.stop=function(a){this.l=Z;this.Da=F();if(a)for(a=this.ba;a<this.s.length;++a){var b=this.s[a];b.l==Z&&b.play();b.l==Z||b.stop(k)}else this.ba<this.s.length&&this.s[this.ba].stop(p);this.u("stop");me(this)};xe.prototype.Vc=function(){if(this.l==1)this.ba++,this.ba<this.s.length?this.s[this.ba].play():(this.Da=F(),this.l=Z,this.u("finish"),me(this))};function ye(a){this.Ba=a;this.q=n;this.nc=[];this.Tb=[]}
function ze(a,b,c,d,e,f){function g(a){var b=a*a;a*=a*a;return 6*a*b+-15*b*b+10*a}z(a.q)&&a.Wc();a.q=new we;var i=a.Ba.getPosition();a.nc=[0,0,a.Ba.getHeading(),a.Ba.getTilt()];a.Tb=[0,0,e||0,f||0];Ae(a,i[0],i[1],b,c);e=["begin","animate","end"];f=new se(a.nc,a.Tb,3E3,g);U(f,e,a.gf,p,a);a.q.add(f);if(d)c=de(i[0],i[1],b,c),b=a.Ba.I,c=Math.min(b,d)+c*0.2,c=Math.max(Math.max(b,d),c),b=new se([b],[c],1500,g),d=new se([c],[d],1500,g),U(b,e,a.Xd,p,a),U(d,e,a.Xd,p,a),e=new xe,e.add(b),e.add(d),a.q.add(e);
U(a.q,"end",a.Wc,p,a);a.q.play()}function Ae(a,b,c,d,e){var c=L(c,2*Math.PI),e=L(e,2*Math.PI),f=c-e;f<-Math.PI?c+=2*Math.PI:f>Math.PI&&(e+=2*Math.PI);a.nc[0]=b;a.nc[1]=c;a.Tb[0]=d;a.Tb[1]=e}ye.prototype.gf=function(a){this.Ba.setPosition(a.coords[0],a.coords[1]);this.Ba.setHeading(a.coords[2]);this.Ba.setTilt(a.coords[3])};ye.prototype.Xd=function(a){Sc(this.Ba,a.coords[0])};ye.prototype.Wc=function(){if(z(this.q))this.q.v(),this.q=n};ye.prototype.cancel=function(){this.Wc()};function Be(a){this.Cc=a;this.r=U(this.Cc,mb?"DOMMouseScroll":"mousewheel",this)}H(Be,Kc);
Be.prototype.handleEvent=function(a){var b=0,c=0,d=0,a=a.lb;if(a.type=="mousewheel"){c=1;if(O||nb&&(qb||Ab("532.0")))c=40;d=nb&&hb&&-a.wheelDelta%c!=0?-a.wheelDelta:-a.wheelDelta/c;x(a.wheelDeltaX)?(b=nb&&hb&&-a.wheelDeltaX%c!=0?-a.wheelDeltaX:-a.wheelDeltaX/c,c=nb&&hb&&-a.wheelDeltaY%c!=0?-a.wheelDeltaY:-a.wheelDeltaY/c):c=d}else d=a.detail,d>100?d=3:d<-100&&(d=-3),x(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;ea(this.Ld)&&(b=K(b,-this.Ld,this.Ld));ea(this.Md)&&(c=K(c,-this.Md,this.Md));b=new Ce(d,
a,b,c);try{this.dispatchEvent(b)}finally{b.v()}};Be.prototype.w=function(){Be.ma.w.call(this);V(this.r);delete this.r};function Ce(a,b,c,d){b&&this.zb(b,j);this.type="mousewheel";this.detail=a;this.If=c;this.yd=d}H(Ce,Tb);function De(a){this.f=a;this.Td=new Be(a.a.canvas);this.r=U(this.Td,"mousewheel",function(a){this.N(-(a.yd==0?0:a.yd<0?-1:1));a.preventDefault()},p,this);this.we=U(a.a.canvas,"dblclick",E(function(a){Sc(this.b,this.b.I/2);var c=Vc(this,a.offsetX,a.offsetY,k)||Uc(this.b);if(c){var d=(this.b.da+c[1])/2;Math.abs(this.b.da-c[1])>Math.PI&&(d+=Math.PI);this.b.setPosition((this.b.V+c[0])/2,d)}a.preventDefault()},a));this.mf=U(a.a.canvas,"mouseup",E(function(a){if(Vb(a,2)){Sc(this.b,this.b.I*2);var c=Vc(this,
a.offsetX,a.offsetY,k)||Uc(this.b);c&&this.b.setPosition(2*this.b.V-c[0],2*this.b.da-c[1]);a.preventDefault()}},a));this.bf=U(a.a.canvas,"contextmenu",function(a){a.preventDefault()});this.q=n;this.Ya=this.Xa=0}H(De,Qb);
De.prototype.N=function(a){var b=120;a*=-1;if(this.q){if(this.Ya>this.Xa==a>0)return;this.q.v();this.q=n;b*=(this.f.b.I-this.Xa)/(this.Ya-this.Xa);a=this.Ya;this.Ya=this.Xa;this.Xa=a}else this.Xa=this.f.b.I,this.Ya=K(this.Xa*Math.pow(2,a),250,1E7);if(!(isNaN(b)||b<=0)){var a=this.f.b.getPosition(),c=Uc(this.f.b)||a,d=this.Ya/this.f.b.I;a.push(this.f.b.I);this.q=new se(a,[c[0]+d*(a[0]-c[0]),c[1]+d*(a[1]-c[1]),this.Ya],b);U(this.q,["animate","finish"],function(a){this.f.b.setPosition(a.x,a.y);Sc(this.f.b,
a.n)},p,this);U(this.q,["finish"],this.Ce,p,this);this.q.play(p)}};De.prototype.Ce=function(){if(this.q)this.q.v(),this.q=n};De.prototype.w=function(){V(this.r);V(this.we);V(this.mf);V(this.bf);this.Td.v();this.q.v()};function Ee(a){return 1-Math.pow(1-a,3)};function Fe(a,b){this.f=a;this.Bc=p;this.cc=this.bc=this.R=this.Q=0;this.Ta=this.r=n;U(this.f.a.canvas,"mousedown",E(this.Xc,this));U(Mb(this.f.a.canvas),"mouseup",E(this.Zc,this));this.G=b||n}s=Fe.prototype;s.Xc=function(a){if(Vb(a,0)&&!a.ctrlKey&&!a.altKey){z(this.G)&&this.G.cancel();if(this.Ta)this.Ta.stop(p),this.Ta.v(),this.Ta=n;this.Bc=k;this.bc=this.Q=a.screenX;this.cc=this.R=a.screenY;if(!y(this.r))V(this.r),this.r=n;this.r=U(Mb(this.f.a.canvas),"mousemove",E(this.Yc,this));a.preventDefault()}};
s.Zc=function(a){if(this.Bc){a.preventDefault();this.Bc=p;if(!y(this.r))V(this.r),this.r=n;if(Vb(a,0)){var b=a.screenX-this.bc,c=a.screenY-this.cc,a=Math.sqrt(Math.pow(b,2)+Math.pow(c,2));b/=a;c/=a;this.Q==this.bc&&this.R==this.cc&&(a*=2);if(a>6)a=Math.max(15,a)*6,this.Ta=new se([this.Q,this.R],[this.Q+a*b,this.R+a*c],1300,Ee),U(this.Ta,["animate"],this.Ie,p,this),this.Ta.play(p)}}};
s.kc=function(a,b){var c=Math.PI*(1/this.f.a.canvas.height)*(this.f.rc/Math.pow(2,ce(this.f.z,k)));Rc(this.f.b,b*c,-2*a*c)};s.Yc=function(a){this.kc(a.screenX-this.Q,a.screenY-this.R);this.bc=this.Q;this.cc=this.R;this.Q=a.screenX;this.R=a.screenY;a.preventDefault()};s.Ie=function(a){this.kc(a.x-this.Q,a.y-this.R);this.Q=a.x;this.R=a.y};function Ge(a,b){this.f=a;this.wa=j;this.R=this.Q=this.be=0;this.r=n;U(this.f.a.canvas,"mousedown",E(this.Xc,this));U(Mb(this.f.a.canvas),"mouseup",E(this.Zc,this));this.G=b||n}
Ge.prototype.Xc=function(a){if(!Vb(a,2)&&!a.ctrlKey&&!a.altKey){z(this.G)&&this.G.cancel();this.Q=a.screenX;this.R=a.screenY;if(Vb(a,1)||Vb(a,0)&&a.shiftKey)if(this.wa=Uc(this.f.b),z(this.wa)){if(window.xb)window.xb.lat=N(this.wa[0]),window.xb.W=N(this.wa[1]),window.xb.enable(k);this.be=this.f.b.getTilt()==0?this.f.b.I:Math.sin(Math.PI-this.f.b.getTilt()-(Math.PI-Math.asin((1+this.f.b.I/6378137)*Math.sin(this.f.b.getTilt()))))/Math.sin(this.f.b.getTilt())*6378137}if(!y(this.r))V(this.r),this.r=n;
this.r=U(Mb(this.f.a.canvas),"mousemove",E(this.Yc,this));a.preventDefault()}};Ge.prototype.Zc=function(a){a.preventDefault();this.wa=j;window.xb&&window.xb.enable(p);if(!y(this.r))V(this.r),this.r=n};
Ge.prototype.kc=function(a,b){if(x(this.wa)){var c=a/this.f.a.canvas.width*Math.PI*-2,d=b/this.f.a.canvas.height*Math.PI/2;if(y(this.wa))this.f.b.setHeading(this.f.b.getHeading()+c),this.f.b.setTilt(this.f.b.getTilt()+d);else{var e=this.f.b,f=this.wa[0],g=this.wa[1],i=this.be;e.mb+=c;c=Math.asin(6378137/Math.sqrt(i*i+40680631590769));e.ya=K(e.ya+d,-c,c);d=Math.asin(i/6378137*Math.sin(e.ya));Math.abs(e.ya)<1.0E-4?Sc(e,i):Sc(e,(Math.sin(Math.PI-e.ya-d)/Math.sin(e.ya)-1)*6378137);f-=Math.cos(e.mb)*d;
e.setPosition(f,g+Math.sin(e.mb)*d/Math.cos(f))}}};Ge.prototype.Yc=function(a){this.kc(a.screenX-this.Q,a.screenY-this.R);this.Q=a.screenX;this.R=a.screenY;a.preventDefault()};function He(a,b){this.f=a;this.Cc=b;this.ta=new Xa}function Ie(a,b){var c=sa(),d=a.Cc;b.parentElement&&b.detach();b.parentElement=d;b.parentElement.appendChild(b.element);a.ta.set(c,b);return c}function Je(a,b){var c=a.ta.get(b);x(c)&&(c.detach(),a.ta.remove(b))}
He.prototype.Df=function(a){a=this.ta.get(a);if(a.isEnabled()){var b;a:{var c=this.f;b=a.lat;var d=a.W;b=M(b);var d=M(d),e=Math.cos(b),e=new xc(Math.sin(d)*e,Math.sin(b),Math.cos(d)*e),d=c.a.Eb.multiply(new W([[e.x],[e.y],[e.n],[1]]));if(X(d,3,0)==0)b=n;else{d=d.multiply(1/X(d,3,0));b=(X(d,0,0)+1)/2*c.a.ia;var d=(X(d,1,0)-1)/-2*c.a.ha,f=1;if(b<0||b>c.a.ia||d<0||d>c.a.ha)f=0;else{f=Jc(0.5,0.5,0,c.a.Fb,1,1);if(y(f)){b=n;break a}c=yc(e,f);e=e.hd(f).normalize();e=he(f,e);f=y(e)?0:Math.abs(c-e[0])<Math.abs(c-
e[1])?1:0}b=[b,d,f]}}z(b)?(a.lc(b[0],b[1]),a.show(b[2]>0)):a.show(p)}};He.prototype.forEach=function(a){J(this.ta.yb(),function(b){(b=this.ta.get(b))&&a(b)},this)};function Ke(a,b){Wd.call(this,"Bing Maps - "+a);var c="bingsCallback_"+a,d="http://dev.virtualearth.net/REST/V1/Imagery/Metadata/"+a+"?key="+b+"&jsonp="+c;v[c]=x(v[c])?od(E(this.de,this),v[c]):E(this.de,this);c=document.createElement("script");c.src=d;c.type="text/javascript";Hb()[0].appendChild(c)}H(Ke,Wd);s=Ke.prototype;s.Mc=function(){return!y(this.fa)};s.de=function(a){this.Db=a;if(a.resourceSets.length>0)this.fa=a.resourceSets[0].resources[0],Ad(this);this.zc()};
s.Sa=function(){return y(this.fa)?0:this.fa.zoomMin};s.Fa=function(){return y(this.fa)?18:this.fa.zoomMax};s.Ga=ba(256);function Le(a,b,c){for(var d="",e=1;e<=a;e++)d+=(c>>a-e&1)<<1|b>>a-e&1;return d}s.Jc=function(a,b,c){return y(this.fa)?"":this.fa.imageUrl.replace("{subdomain}",this.fa.imageUrlSubdomains[Math.floor(Math.random()*this.fa.imageUrlSubdomains.length)]).replace("{quadkey}",Le(a,b,c))};s.Cb=function(a,b,c){return y(this.fa)?p:Ke.ma.Cb.call(this,a,b,c)};
s.Oa=function(a){y(this.Db)||Q(a,this.Db.copyright)};s.Wb=function(){return!y(this.Db)?this.Db.brandLogoUri:n};s.Db=n;s.fa=n;function Me(a,b,c){function d(){y(Ne)&&(Ne=new google.maps.Map(document.createElement("div")));Oe?e():google.maps.event.addListenerOnce(Ne,"idle",function(){Oe=k;e()})}xd.call(this,"Google Maps - "+a);this.la=n;this.Re=a;this.Ke=b||0;this.hf=c||w;this.Sb=new ab;this.Qc=0;this.Rc=[];var e=E(function(){this.la=Ne.mapTypes[Pe(a)];Ad(this);this.hf()},this);z(v.google)&&google.maps&&google.maps.Map?d():y(Qe)?(Qe="googleMapsCallback"+sa(),v[Qe]=E(d,this),b=document.createElement("script"),Hb()[0].appendChild(b),
b.type="text/javascript",b.src="http://maps.google.com/maps/api/js?v=3.5&sensor=false&callback="+Qe):v[Qe]=od(v[Qe],E(d,this))}H(Me,xd);Me.prototype.Mc=function(){return!y(this.la)};var Qe=n,Ne=n,Oe=p;s=Me.prototype;s.Sa=function(){return y(this.la)?0:this.la.minZoom||0};s.Fa=function(){return y(this.la)?18:this.la.maxZoom};s.Ga=function(){return y(this.la)?256:this.la.tileSize.width};
s.Cb=function(a,b,c){var d=E(function(a){a=a.getElementsByTagName("img");return a[this.Ke]||a[0]},this);a.xd=d;a.vd=E(function(a){this.la.releaseTile(a)},this);var e=this.la.getTile(new google.maps.Point(a.x,a.y),a.zoom,document),d=d(e);d.onload=E(function(){if(rd(a).src==rd(a).__src__)a.state=20,this.ca--,b(a)},this);d.onerror=E(function(){a.Dc++;a.state=-10;this.ca--;c&&c(a)},this);a.setData(e);a.state=10;this.ca++};
s.Oa=function(a){this.Sb.ra()>0&&Q(a,"Map Data \u00a9 "+(new Date).getFullYear()+" "+this.Sb.Ha().join(", ")+" \u2013 ");Q(a,P("a",{href:"http://www.google.com/intl/en-US_US/help/terms_maps.html",target:"_blank"},"Terms of Use"))};s.Wb=ba("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD4AAAAYCAMAAACV6r5dAAABI1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABxcXEAAAAAAAAAAAAAAAAAAAAAAAAAAAAJCQkLCwsRERESEhIZGRkjIyMsLCw6OjpNTU1WVlZhYWFvb28AAABycnJ5eXl8fHzc3NyFhYWGhoaHiIeLi4uSkpKWlpaYmJiampqenp6mpqahoaGlpaWhoaGpqampqamrq6uqqqqur66vr6+usK6ysrK4uLi9vb3CwsLExMTJycnNzc3Q0NDT09PU1NTV1dXX19fZ2dmDg4Pg4ODi4uLj4+Pj4+Pl5eXk5OTl5eXk5OTl5eXk5OTo6Ojq6urv7+/x8fH5+fn9/f3////54OudAAAAYHRSTlNgXlpSTUY/Pjs5NTMwLSsoJiQiIB4cGhcUEgoBAAYXJy43QElWWV1SFRwQQp2LiaQyqYmwRIi1hwi5hyiEWrxsfwW/xMTJycW3qA2ajweNi4+YAdios7vFy5/g6vD2/P7aB358AAADLElEQVR4XpWUe3OiSBTFOxpMfDsqKt2dZGeiBBlx8zABx3EiZBJk8phsMyb4wvv9P8VexCpnq7aym/PX6Uv/qpt7uBDOuRB8IzRva2AYxinbbkNcrKvTqdGrMvtt2hoG4Es63+JIa9PAM03PX81GNf1NXPAR3O5av+GCn858kvlQLe+bcJfRORORYuB3G/sHuJXsbZ1wZbYgaU23bPrxcqd4wGMygsQ/bKynCN/WCTegsxtfWa8dHVhxe3oNigTaZ+OzorPIDofD62EtOv0H14a4RUGKKLOwWUAIxWxLcPr8apo+jDOHXJlGduXldT6YeuNwdWeWI5wNgnusf61YnJyu5uSQb4THTBckV8m44GaVl3kiV0n54JTkmZvKmeCT6PTUYPFtv7q3AFURZAgLUuds0xw+hG+7skVPQlCv4UzSbNqFkDxAK23lfThb49MVyQ8e/JtWXZDeKmy1t0n8BRd7GH47gL4LHQyCF2fwJ9q8YPfQLyGenC3V+8moKRUOOTlewFX+ERP9YaA+T8DZwxX7BTe3cJG1GVde4MqBm/QjN0CN8J0ZdLrpUlU/YJxQD+Y7mhDYZRNv7MFd0sJMnuHiNo6Y/oJOawnn5ePASTSe8HkAV/uyrq+DYydL+J7BmChNz8NPXVg265jZBMg5duUI669LkjlxfXfhJGSOuPSAe5Q4eSKULytw/6C4qmAz02NwU4z3wn4i/QLfs4wPw7NdrZ5NzKGTstafTdqHebfUGAyYIPyx3fVhOXm6vr5f+M1q1gn9kRH0E8d0zw1dtJdJ2eY058KyW8M3mTvNlg8wCzyZIs7tuqQ6ruuNTJVkNL3YMs2vrYxMLZpXTfNLMyMzakw8x4fVebmnqt3jekq96v+U2jpfz7teK2SzxUq7qumM2Uq7UqtpDOt2o12N7OHr/GczlezDItmoVeqKjkC+dKQzxONxsi1LtzaTiH7juLB0EcWgSkeaVRiDWheWiAE7nrj/EuP0BdRcNKGjJanheqP/iUdD7n/EpOSgL2mcvwtHRbdevk5x/qRP7P24oAX1YuxctnIy5e/HMZrGh0Kx3MY43o1vo/mX3/jfzoX94Q7k9zgAAAAASUVORK5CYII=");
s.ae=function(a){this.Sb=new ab;var b=v.GAddCopyright,c=v.GVerify,d=v.GAppFeatures;v.GAddCopyright=E(function(){arguments.length>7&&arguments[7].length>0&&this.Sb.add(arguments[7])},this);v.GVerify=md;v.GAppFeatures=E(function(){this.Qc--;if(this.Qc<=0)v.GAddCopyright=b,v.GVerify=c,v.GAppFeatures=d,J(this.Rc,function(a){a.parentNode.removeChild(a)}),this.Rc=[],this.zc()},this);J(a,function(a){var b=document.createElement("script");Hb()[0].appendChild(b);b.type="text/javascript";this.Rc.push(b);b.src=
"http://maps.google.com/maps?vp="+(N(a.te)+","+N(a.ue))+"&z="+a.Ff+"&spn="+(N(a.tf)+","+N(a.uf))+"&t="+Re(this.Re);this.Qc++},this)};function Pe(a){switch(a){case "Terrain":return google.maps.MapTypeId.TERRAIN;case "Hybrid":return google.maps.MapTypeId.HYBRID;case "Roadmap":return google.maps.MapTypeId.ROADMAP;default:case "Satellite":return google.maps.MapTypeId.SATELLITE}}
function Re(a){switch(a){case "Terrain":return"p";case "Hybrid":return"h";case "Roadmap":return"m";default:case "Satellite":return"k"}}var Se=E(document.createElement,document);document.createElement=function(a){var b=Se(a);if(a=="img")b.crossOrigin="";return b};function Te(a){Xd.call(this,a||"OpenStreetMaps","http://{sub}.tile.openstreetmap.org/{z}/{x}/{y}.png",0,18,256,p,["a","b","c"])}H(Te,Xd);Te.prototype.Oa=function(a){Q(a,"\u00a9 ",P("a",{href:"http://www.openstreetmap.org/"},"OpenStreetMap")," contributors, CC-BY-SA")};function Ue(a,b,c,d,e,f,g,i,l,m){Wd.call(this,a);b.charAt(b.length-1)!="?"&&(b+="?");this.uc=0;if(b.length>0)this.url=b,this.uc=1;this.version=c;this.Le=d;this.format=f;this.minZoom=l;this.maxZoom=m;this.tileSize=256;e=="EPSG:900913"||e=="EPSG:3857"?this.ee=e:(this.uc=0,h(Error(e+" is an unsupported CRS, please use either EPSG:900913 or EPSG:3857.  WMS Server must support one of these.")));this.styles=g;i.length>0&&i.charAt(0)!="&"&&(i="&"+i);this.De=i}H(Ue,Wd);Ue.prototype.Sa=q("minZoom");
Ue.prototype.Fa=q("maxZoom");Ue.prototype.Ga=ba(256);
Ue.prototype.Jc=function(a,b,c){function d(a,b){var c=Math.PI-2*Math.PI*a/Math.pow(2,b);return 180/Math.PI*Math.atan(0.5*(Math.exp(c)-Math.exp(-c)))}function e(a){a>89.5&&(a=89.5);a<-89.5&&(a=-89.5);a=Math.tan(0.5*(Math.PI*0.5-a*(Math.PI/180)));return 0-6378137*Math.log(a)}var f="";if(this.uc==1){var f=e(d(c,a)),g=e(d(c+1,a)),c=6378137*(b/Math.pow(2,a)*360-180)*(Math.PI/180),i=6378137*((b+1)/Math.pow(2,a)*360-180)*(Math.PI/180),a=Math.max(f,g),b=Math.max(c,i),g=Math.min(f,g),c=Math.min(c,i),f=this.url+
"service=WMS&request=GetMap&version="+this.version,f=f+"&Width="+this.tileSize+"&Height="+this.tileSize,f=f+"&Layers="+this.Le+"&Format="+this.format;this.version.substr(0,3)=="1.0"||this.version.substr(0,3)=="1.1"?f=f+"&SRS="+this.ee:this.version.substr(0,3)=="1.3"&&(f=f+"&CRS="+this.ee);f=f+"&STYLES="+this.styles;f=f+"&BBOX="+c+","+g+","+b+","+a;f+=this.De}return f};function Ve(a){this.eb=a}Ve.prototype.dd=function(a,b,c,d){this.eb.dd(a,b,c,d)};Ve.prototype.qf=function(a){this.eb.opacity=a};Ve.prototype.Fe=function(){return this.eb.opacity};var We=new Xa;function Xe(a,b){var c=a;z(b)&&b.length>0&&(c+=b[0]);var d;switch(a){case "mapquest":d=Yd;break;case "osm":d=Te;break;case "bing":d=Ke;break;case "wms":d=Ue;break;case "gooogle":d=Me;break;case "custom":d=Xd;break;default:return alert("Unknown MapType '"+a+"' !"),n}d=function(a,b){function c(b){a.apply(this,b)}c.prototype=a.prototype;return new c(b)}(d,b);d=new Ve(d);We.set(c,d);return d}function Ye(a,b){var c=a;z(b)&&(c+=b);return We.get(c)};function Ze(a,b){var c=b||{},d=C(a)?document.getElementById(a):a;if(!y(d)){var e=P("canvas",{style:"width:100%;height:100%;"});this.a=new bd(e,n,function(){var a=P("a",{style:"font-size:110%;display:block;width:100%;top:50%;position:relative;text-align:center;color:#800000;text-shadow:rgba(0,0,0,0.4) 0 0 6px;",href:"http://www.webglearth.com/upgrade.html"},"You need a WebGL-enabled browser to run this application.");Q(d,a)});if(z(this.a)){cd(this.a);var f=P("div",{style:"width:100%;height:100%;position:relative;"});
Q(d,f);Q(f,e);Xe("mapquest");Xe("osm");this.Jd=new sd(15);U(this.Jd,ud,E(function(){var a=this.a,b=a.d;if(!y(a.Gc)){var c=F();if(a.Nc<F()-2E3)a.Fc=1E3*a.Vb/(F()-a.Nc),a.sd=a.Hc/a.Vb,a.Nc=F(),a.Vb=0,a.Hc=0,a.Gc.innerHTML=a.sd.toFixed(2)+" ms / fps: "+a.Fc.toFixed(2);a.Vb++}b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT);a.O.K=Ac(4);a.c.draw();!y(a.Gc)&&(a.Hc+=F()-c);if(a.Qb)a.Qb(),a.Qb=n;a=this.$b;J(a.ta.yb(),a.Df,a)},this));var e=P("img",{style:"position:absolute;bottom:0;right:0"}),g=P("div",{style:"position:absolute;bottom:5px;left:5px;width:75%;font-size:8px;text-align:justify;color:#fff;font-family:Verdana,Arial;text-shadow:rgba(0,0,0,0.8) 0 0 4px;"});
Q(f,e);Q(f,g);this.a.c=new ge(this.a,j,g,e,z(c.map)?Ye(c.map).eb:j,P("p",n,"Powered by ",P("a",{href:"http://www.webglearth.org/",style:"color:#00f"},"WebGL Earth"),"."),c.atmosphere===p);this.$b=new He(this.a.c,f);f=c.position;e=c.center;z(f)&&f.length>1?this.a.c.b.setPosition(M(f[0]),M(f[1])):z(e)&&e.length>1&&this.a.c.b.setPosition(M(e[0]),M(e[1]));f=c.zoom;z(f)&&this.a.c.z.setZoom(f);f=c.altitude;z(f)&&Sc(this.a.c.b,f);f=c.proxyHost;if(C(f))this.a.Hb=f;this.G=new ye(this.a.c.b);this.kf=n;if(c.panning!==
p)this.kf=new Fe(this.a.c,this.G);this.Bf=n;if(c.tilting!==p)this.Bf=new Ge(this.a.c,this.G);this.Gf=n;if(c.zooming!==p)this.Gf=new De(this.a.c);this.a.Ib();this.Jd.start()}}}s=Ze.prototype;s.setMap=function(a,b){var c=Ye(a,b);z(c)&&this.a.c.z.pa(c.eb)};s.of=function(a){this.a.c.z.pa(a.eb)};s.rf=function(a){this.a.c.z.pa(z(a)?a.eb:n,p,k)};s.od=function(a){return E(function(b){var c=Vc(this.a.c,b.offsetX,b.offsetY);b.target=this;b.latitude=z(c)?c[0]:n;b.longitude=z(c)?c[1]:n;a(b)},this)};
s.ff=function(a,b){var c=U(this.a.canvas,a,this.od(b));return b[D(this)+"___eventKey_"+a]=c};s.Wd=function(a,b){if(z(b)){var c=b[D(this)+"___eventKey_"+a];z(c)&&V(c)}else C(a)||V(a)};s.df=function(a){tc(this.a.canvas,a)};s.Je=function(a,b,c,d,e){a=new ke(a,b,c,d,e);Ie(this.$b,a);return a};G("WebGLEarth",Ze);G("WebGLEarth.prototype.setCenter",function(a){this.G.cancel();this.a.c.b.setPosition(M(a[0]),M(a[1]));this.a.c.b.setTilt(0)});G("WebGLEarth.prototype.getCenter",function(){return[N(this.a.c.b.V),N(this.a.c.b.da)]});G("WebGLEarth.prototype.setPosition",function(a,b,c){this.G.cancel();this.a.c.b.setPosition(M(a),M(b));z(c)&&this.a.c.z.setZoom(c)});G("WebGLEarth.prototype.getPosition",function(){return[N(this.a.c.b.V),N(this.a.c.b.da)]});
G("WebGLEarth.prototype.setAltitude",function(a){this.G.cancel();Sc(this.a.c.b,a)});G("WebGLEarth.prototype.getAltitude",function(){return this.a.c.b.I});G("WebGLEarth.prototype.setHeading",function(a){this.G.cancel();this.a.c.b.setHeading(M(a))});G("WebGLEarth.prototype.getHeading",function(){return N(this.a.c.b.getHeading())});G("WebGLEarth.prototype.setTilt",function(a){this.G.cancel();this.a.c.b.setTilt(M(a))});G("WebGLEarth.prototype.getTilt",function(){return N(this.a.c.b.getTilt())});
G("WebGLEarth.prototype.setRoll",function(a){this.G.cancel();this.a.c.b.ic=M(a)});G("WebGLEarth.prototype.getRoll",function(){return N(this.a.c.b.ic)});G("WebGLEarth.prototype.setZoom",function(a){this.G.cancel();this.a.c.z.setZoom(a)});G("WebGLEarth.prototype.getZoom",function(){return this.a.c.z.getZoom()});G("WebGLEarth.prototype.flyTo",function(a,b,c,d,e){ze(this.G,M(a),M(b),c,d,e)});
G("WebGLEarth.prototype.flyToFitBounds",function(a,b,c,d){var a=M(a),b=M(b),c=M(c),d=M(d),e;e=this.a.Ea;var f=(a+b)/2,f=de(f,c,f,d),g=de(a,0,b,0),i=Math.min(Math.max(this.a.gb,f/g),1);e=M(N(e)/(i+0.4)-2);f=Math.max(g,f);f=Math.min(Math.PI/2,e+f/12756274);e=9567205.5*(Math.sin(f)*Math.sqrt(1+1/Math.pow(Math.tan(e),2))-1);c=L(c,2*Math.PI);d=L(d,2*Math.PI);f=c-d;f<-Math.PI?c+=2*Math.PI:f>Math.PI&&(d+=2*Math.PI);a=[(a+b)/2,(c+d)/2];b=be(this.a.c.z,this.a.c.z.L.Fa()+0.1,a[0]);ze(this.G,a[0],a[1],Math.max(e,
b))});G("WebGLEarth.prototype.handleResize",function(){return this.a.Ib()});G("WebGLEarth.prototype.saveScreenshot",function(a){this.a.Qb=E(function(){Ja(this.a.canvas,a,this.$b,this.a.c.ob)},this)});
G("WebGLEarth.prototype.showMiniGlobe",function(a,b){if(z(a)){this.a.c.ob=new fe(this.a.c,32,32,a);var c=this.a.c.ob;c.e=b;if(z(j))c.ad=j;c.canvas.width=c.e;c.canvas.height=c.e;c.d.viewport(0,0,c.canvas.width,c.canvas.height);var d=c.ad*c.e;c.canvas.style.cssText="position:absolute;z-index:10000;pointer-events:none;right:"+d+"px;bottom:"+d+"px;"}else this.a.c.ob=n});G("WebGLEarth.Maps",{MAPQUEST:"mapquest",OSM:"osm",BING:"bing",WMS:"wms",GOOGLE:"gooogle",CUSTOM:"custom"});
G("WebGLEarth.prototype.initMap",Xe);G("WebGLEarth.prototype.setMap",Ze.prototype.setMap);G("WebGLEarth.prototype.setBaseMap",Ze.prototype.of);G("WebGLEarth.prototype.setOverlayMap",Ze.prototype.rf);G("WebGLEarth.prototype.on",Ze.prototype.ff);G("WebGLEarth.prototype.off",Ze.prototype.Wd);G("WebGLEarth.prototype.offAll",Ze.prototype.df);G("WebGLEarth.prototype.initMarker",Ze.prototype.Je);G("WebGLEarth.Map",Ve);G("WebGLEarth.Map.prototype.setBoundingBox",Ve.prototype.dd);
G("WebGLEarth.Map.prototype.setOpacity",Ve.prototype.qf);G("WebGLEarth.Map.prototype.getOpacity",Ve.prototype.Fe);G("WebGLEarth.Marker",ke);G("WebGLEarth.Marker.prototype.setPosition",function(a,b){this.lat=a;this.W=b});G("WebGLEarth.Marker.prototype.bindPopup",function(a,b,c){a=new ie(a,b,c);if(this.D)(b=this.D.D)&&b.parentNode&&b.parentNode.removeChild(b);this.D=a;this.element.appendChild(this.D.D);a.D.style.bottom=this.ka.toFixed(0)+"px";return this});
G("WebGLEarth.Marker.prototype.openPopup",function(){this.mc(k)});G("WebGLEarth.Marker.prototype.closePopup",function(){this.mc(p)});ke.prototype.od=function(a){return E(function(b){b.target=this;b.latitude=this.lat;b.longitude=this.W;a(b)},this)};G("WebGLEarth.Marker.prototype.on",function(a,b){var c=U(this.element,a,this.od(b));return b[D(this)+"___eventKey_"+a]=c});G("WebGLEarth.Marker.prototype.off",Ze.prototype.Wd);G("WebGLEarth.Marker.prototype.offAll",function(a){tc(this.element,a)});var $e=/#(.)(.)(.)/;function af(a){bf.test(a)||h(Error("'"+a+"' is not a valid hex color"));a.length==4&&(a=a.replace($e,"#$1$1$2$2$3$3"));return a.toLowerCase()}var bf=/^#(?:[0-9a-f]{3}){1,2}$/i;function cf(a){var d;this.a=a;d=this.d=a.d,a=d;this.p=n;this.o=[];this.Gb=0;this.$=a.createBuffer();this.Ia=a.createBuffer();this.Vd=0;var b=Vd("polygon-fs.glsl"),c=Vd("polygon-vs.glsl"),b=id(this.a,b,a.FRAGMENT_SHADER),c=id(this.a,c,a.VERTEX_SHADER);this.g=a.createProgram();y(this.g)&&h(Error("Unknown"));a.attachShader(this.g,c);a.attachShader(this.g,b);a.bindAttribLocation(this.g,0,"aVertexCoords");a.linkProgram(this.g);a.getProgramParameter(this.g,a.LINK_STATUS)||h(Error("Shader program err: "+
a.getProgramInfoLog(this.g)));this.tc=a.getAttribLocation(this.g,"aVertexCoords");this.Cf=a.getUniformLocation(this.g,"uMVPMatrix");this.ge=a.getUniformLocation(this.g,"uColor");this.fillColor=[1,0,0,0.8];this.strokeColor=[0,0,0,1];this.jc=0;this.ec=this.za=p;this.ld=[]}s=cf.prototype;s.Yb=q("za");function df(a){var b=a.ec;a.ec=p;return b}s.Ic=q("jc");
s.vb=function(a,b,c){a=new ef(a,b);if(this.Gb==0)this.p=a,a.next=a,a.H=a;else{c=this.o[K(z(c)?c:Number.MAX_VALUE,0,this.o.length-1)];if(!c)c=this.p.H;a.next=c.next;c.next=a;a.H=c;a.next.H=a}this.o.push(a);a.Ub=this.o.length-1;this.Gb++;ff(this);gf(this);return a.Ub};function hf(a,b){var c=a.o[b];return!c?[]:[c.H.Ub,c.next.Ub]}function jf(a,b){var c=a.o[b];if(!c)return[];var d=180/Math.PI;return[c.x*d,c.y*d]}s.pb=function(a,b,c){if(a=this.o[a])kf(a,b,c),ff(this),gf(this)};
s.rb=function(a){var b=this.o[a];if(b){if(this.p==b)this.p=b==b.next?n:b.next;b.next.H=b.H;b.H.next=b.next;delete this.o[a];this.Gb--;ff(this);gf(this)}};s.Lc=function(a,b){function c(a,b){return(d-b.x)*(a.y-b.y)-(a.x-b.x)*(e-b.y)}var d=b/180*Math.PI,e=a/180*Math.PI,f=p;J(this.ld,function(a){var b=c(a[1],a[2])<0,d=c(a[2],a[0])<0;c(a[0],a[1])<0==b&&b==d&&(f=k)});return f};
function ff(a){var b=[];if(a.p){var c=a.p,d=0;do c.cb=d++,c=c.next;while(c!=a.p);J(a.o,function(a){if(a)b[3*a.cb+0]=a.fc,b[3*a.cb+1]=a.gc,b[3*a.cb+2]=a.hc});c=a.d;c.bindBuffer(c.ARRAY_BUFFER,a.$);c.bufferData(c.ARRAY_BUFFER,new Float32Array(b),c.STATIC_DRAW)}}
function gf(a){var b=a.Gb;a.jc=0;a.ld=[];a.za=p;if(b>2){var c=n;a.za=k;var d=a.p;do{var e=k,f=d.next,g=a.p;do{var i=g.next,l=(i.y-g.y)*(f.x-d.x)-(i.x-g.x)*(f.y-d.y),m=((i.x-g.x)*(d.y-g.y)-(i.y-g.y)*(d.x-g.x))/l,g=((f.x-d.x)*(d.y-g.y)-(f.y-d.y)*(d.x-g.x))/l;m>0&&m<1&&g>0&&g<1&&(e=p);g=i}while(e&&g!=a.p);e&&(c=d);a.za=a.za&&e;d=f}while(d!=a.p);if(!a.za&&b==4)c&&function(a,b){var c=a.H,d=b.next;a.H=b;b.next=a;a.next=d;b.H=c;d.H=a;c.next=b}(c,c.next),ff(a),a.za=k,a.ec=k}if(a.za){c=0;if(b>0){d=a.p;do f=
d.next,c+=d.x*f.y-d.y*f.x,d=f;while(d!=a.p)}if(c>0){a.ec=k;for(d=0;d<a.o.length;++d)if(f=a.o[d])c=f.next,f.next=f.H,f.H=c;ff(a)}var r=[],d=E(function(a,b,c){function d(a,b){var c=a.fc-b.fc,e=a.gc-b.gc,f=a.hc-b.hc;return Math.sqrt(c*c+e*e+f*f)}r.push([a.cb,b.cb,c.cb]);this.ld.push([a,b,c]);var e=d(a,b),b=d(b,c),a=d(c,a),c=(e+b+a)/2;this.jc+=Math.sqrt(c*(c-e)*(c-b)*(c-a))},a);if(!(b<3))if(b==3)d(a.p,a.p.H,a.p.next);else{var o=a.p,t=function(a,b,c){return-((b.x-a.x)*(c.y-a.y)-(c.x-a.x)*(b.y-a.y))},u=
function(a,b){var c=a.fb,d=a.ja;return t(a,d,c)>=0?t(a,b,c)>0&&t(b,a,d)>0:!(t(a,b,d)>=0&&t(b,a,c)>=0)},f=function(a,b){var c;if(c=u(a,b))if(c=u(b,a))a:{c=o;var d;do{d=c.ja;if(c!=a&&d!=a&&c!=b&&d!=b&&(t(a,b,c)==0||t(a,b,d)==0||t(c,d,a)==0||t(c,d,b)==0?0:(t(a,b,c)>0||t(a,b,d)>0)&&!(t(a,b,c)>0&&t(a,b,d)>0)&&(t(c,d,a)>0||t(c,d,b)>0)&&!(t(c,d,a)>0&&t(c,d,b)>0))){c=p;break a}c=c.ja}while(c!=o);c=k}return c},B,ha;J(a.o,function(a){if(a)a.ja=a.next,a.fb=a.H});c=a.p;do e=c.ja,g=c.fb,c.Pb=f(g,e),c=c.ja;while(c!=
a.p);for(i=99;i>0&&b>3;){i--;e=o;m=99;do{g=p;if(e.Pb)B=e.ja,ha=B.ja,c=e.fb,g=c.fb,d(B,e,c),c.Pb=f(g,B),B.Pb=f(c,ha),c.ja=B,B.fb=c,o=B,b--,g=k;e=e.ja;m--}while(m>0&&!g&&e!=o)}c&&B&&ha&&d(ha,B,c)}b=Da(r);a.Vd=b.length;B=a.d;B.bindBuffer(B.ELEMENT_ARRAY_BUFFER,a.Ia);B.bufferData(B.ELEMENT_ARRAY_BUFFER,new Uint16Array(b),B.STATIC_DRAW);a.jc*=40680631590769}}
s.draw=function(){var a=this.d;a.enable(a.BLEND);a.disable(a.DEPTH_TEST);a.useProgram(this.g);var b=new Float32Array(Da(Ec(this.a.Eb).Na()));a.uniformMatrix4fv(this.Cf,p,b);a.bindBuffer(a.ARRAY_BUFFER,this.$);a.vertexAttribPointer(this.tc,3,a.FLOAT,p,0,0);a.enableVertexAttribArray(this.tc);this.za&&(a.uniform4fv(this.ge,this.fillColor),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.Ia),a.drawElements(a.TRIANGLES,this.Vd,a.UNSIGNED_SHORT,0));a.uniform4fv(this.ge,this.strokeColor);a.drawArrays(a.LINE_LOOP,
0,this.Gb);a.disableVertexAttribArray(this.tc);a.disable(a.BLEND);a.enable(a.DEPTH_TEST)};function ef(a,b){this.hc=this.gc=this.fc=this.y=this.x=0;kf(this,a,b);this.H=this.next=n;this.cb=this.Ub=-1;this.Pb=p;this.ja=this.next;this.fb=this.H}function kf(a,b,c){a.x=c/180*Math.PI;a.y=b/180*Math.PI;b=Math.cos(a.y);a.fc=Math.sin(a.x)*b;a.gc=Math.sin(a.y);a.hc=Math.cos(a.x)*b};function lf(a,b,c,d,e,f,g){var i=P("div",{"class":"we-polydragger-"+(z(d)?"a":"b")});je.call(this,a,b,i);this.show(p);U(i,"mousedown",function(a){a.button==0&&(U(c.a.canvas,"mousemove",function(a){var b=Vc(c,a.offsetX,a.offsetY);if(b){this.lat=b[0];this.W=b[1];this.lc(a.offsetX,a.offsetY);if(z(d))e(d,this.lat,this.W);else if(g)d=g(this.lat,this.W),i.className="we-polydragger-a";a.preventDefault()}},p,this),a.preventDefault())},p,this);U(i,"click",function(a){a.altKey&&z(d)&&(f(d),a.preventDefault())},
p,this);U(i,"mouseup",function(){tc(c.a.canvas,"mousemove")},p,this)}H(lf,je);Nc(".we-polydragger-a{position:absolute;width:8px;height:8px;z-index:100;margin-left:-4px;margin-top:-4px;background-color:#36f;cursor:pointer;border:1px solid blue;}");Nc(".we-polydragger-b{position:absolute;width:6px;height:6px;z-index:99;margin-left:-3px;margin-top:-3px;background-color:rgba(180,220,250,0.9);cursor:pointer;border:1px solid blue;}");function mf(a,b,c){this.m=P("img",{style:"position:absolute;pointer-events:none;z-index:101;",crossOrigin:n});this.Qd=this.ka=0;this.Nd=n;this.rd=1;this.f=c;je.call(this,a,b,this.m);this.show(p)}H(mf,je);
mf.prototype.lc=function(a,b){mf.ma.lc.call(this,a,b);var c=1E3*this.ka,d;d=this.lat;var e=this.W,f=this.f.a.Fb,f=(new xc(X(f,0,3),X(f,1,3),X(f,2,3))).scale(1/X(f,3,3));d=M(d);var e=M(e),g=Math.cos(d);d=yc(f,new xc(Math.sin(e)*g,Math.sin(d),Math.cos(e)*g));c=K(c/(d*6378137),this.Qd,this.Nd||Number.MAX_VALUE);this.m.height=c;this.m.width=c*this.rd;this.m.style.marginLeft="-"+this.m.width/2+"px";this.m.style.marginTop="-"+this.m.height/2+"px";this.m.style.display="block"};
mf.prototype.ed=function(a,b,c,d){this.m.onload=E(function(){this.rd=this.m.naturalWidth/this.m.naturalHeight},this);this.m.style.display="none";this.m.src=a;this.ka=b;this.Qd=c||0;this.Nd=d||n};mf.prototype.Bd=function(a){this.visible&&a.drawImage(this.m,parseInt(this.m.style.left,10)-this.m.width/2,parseInt(this.m.style.top,10)-this.m.height/2,this.m.width,this.m.height)};function nf(a,b){this.c=a;this.Ka=b;this.C=new cf(a.a);a.qd.push(this.C);this.Qa={};this.ua={};this.Va={};this.wb=n;this.nb=new mf(0,0,a);Ie(this.Ka,this.nb);this.nb.enable(p);this.dc=w;this.Id=0}s=nf.prototype;
s.Ae=function(){if(!z(this.wb))this.wb=U(this.c.a.canvas,"mousedown",function(a){qc(this.c.a.canvas,"mouseup",function(b){if(b.button==0&&!y(this.wb)&&Math.max(Math.abs(a.offsetX-b.offsetX),Math.abs(a.offsetY-b.offsetY))<=3){var c=Vc(this.c,b.offsetX,b.offsetY);if(c)this.vb(c[0],c[1]),b.preventDefault(),this.Id=F()}},p,this)},p,this)};s.ze=function(){V(this.wb);this.wb=n};
s.setFillColor=function(a,b){a=af(a);this.C.fillColor=[parseInt(a.substr(1,2),16)/255,parseInt(a.substr(3,2),16)/255,parseInt(a.substr(5,2),16)/255,z(b)?b:1]};s.setStrokeColor=function(a,b){a=af(a);this.C.strokeColor=[parseInt(a.substr(1,2),16)/255,parseInt(a.substr(3,2),16)/255,parseInt(a.substr(5,2),16)/255,z(b)?b:1]};s.setIcon=function(a,b,c,d){this.nb.ed(a,b,c,d)};s.pf=aa("dc");s.Yb=function(){return this.C.Yb()};s.Ic=function(){return this.C.Ic()};
s.Lc=function(a,b){return F()-this.Id<100?p:this.C.Lc(a,b)};function of(a){var b;b=a.C;if(b.p){var c=0,d=0,e=0,f=b.p;do c+=f.x,d+=f.y,e++,f=f.next;while(f!=b.p);e=e/180*Math.PI;b=[c/e,d/e]}else b=[0,0];a.nb.lat=b[1];a.nb.W=b[0];a.nb.enable(a.C.Yb())}s.sf=function(a,b){La(this.ua,function(b){b.enable(a)},this);b!==k&&La(this.Qa,function(b){this.Ka.ta.get(b).enable(a)},this)};s.Ge=function(){var a=this.C,b=180/Math.PI,c=[],d=a.p;do c.push({lat:d.y*b,lng:d.x*b}),d=d.next;while(d!=a.p);return c};
function pf(a,b){var c=hf(a.C,b);if(c.length>0){var d=jf(a.C,c[0]),e=jf(a.C,b),f=jf(a.C,c[1]);a.ua[b].lat=(e[1]+f[1])/2;a.ua[b].W=(e[0]+f[0])/2;a.ua[c[0]].lat=(d[1]+e[1])/2;a.ua[c[0]].W=(d[0]+e[0])/2}}function qf(a){df(a.C)&&La(a.ua,function(a,c){pf(this,c)},a)}
s.vb=function(a,b,c,d){var e=this.C.vb(a,b,c);d&&z(c)?(this.Qa[e]=this.Va[c],delete this.Va[c]):(c=new lf(a,b,this.c,e,E(this.pb,this),E(this.rb,this)),this.Qa[e]=Ie(this.Ka,c));of(this);c=hf(this.C,e);if(c.length>0){var f=E(function(a){return E(function(b,c){return this.vb(b,c,a,k)},this)},this),g=new lf(a,b,this.c,n,E(this.pb,this),E(this.rb,this),f(e));this.ua[e]=g;this.Va[e]=Ie(this.Ka,g);d&&(a=new lf(a,b,this.c,n,E(this.pb,this),E(this.rb,this),f(c[0])),this.ua[c[0]]=a,this.Va[c[0]]=Ie(this.Ka,
a));pf(this,c[0]);pf(this,e);pf(this,c[1])}qf(this);this.dc();return e};s.pb=function(a,b,c){this.C.pb(a,b,c);var d=this.Ka.ta.get(this.Qa[a]);d.lat=b;d.W=c;qf(this);pf(this,a);of(this);this.dc()};s.rb=function(a){var b=hf(this.C,a);this.C.rb(a);of(this);z(this.Qa[a])&&(Je(this.Ka,this.Qa[a]),delete this.Qa[a],delete this.ua[a],z(this.Va[a])&&(Je(this.Ka,this.Va[a]),delete this.Va[a]));qf(this);b.length>0&&(pf(this,b[0]),pf(this,a),pf(this,b[1]));this.dc()};function $(a){nf.call(this,a.a.c,a.$b)}H($,nf);G("WebGLEarth.Polygon",$);G("WebGLEarth.Polygon.prototype.enableClickToAdd",$.prototype.Ae);G("WebGLEarth.Polygon.prototype.disableClickToAdd",$.prototype.ze);G("WebGLEarth.Polygon.prototype.setFillColor",$.prototype.setFillColor);G("WebGLEarth.Polygon.prototype.setStrokeColor",$.prototype.setStrokeColor);G("WebGLEarth.Polygon.prototype.setOnChange",$.prototype.pf);G("WebGLEarth.Polygon.prototype.isValid",$.prototype.Yb);
G("WebGLEarth.Polygon.prototype.getRoughArea",$.prototype.Ic);G("WebGLEarth.Polygon.prototype.setIcon",$.prototype.setIcon);G("WebGLEarth.Polygon.prototype.showDraggers",$.prototype.sf);G("WebGLEarth.Polygon.prototype.addPoint",$.prototype.vb);G("WebGLEarth.Polygon.prototype.movePoint",$.prototype.pb);G("WebGLEarth.Polygon.prototype.removePoint",$.prototype.rb);G("WebGLEarth.Polygon.prototype.getPoints",$.prototype.Ge);
G("WebGLEarth.Polygon.prototype.onClick",function(a){U(this.c.a.canvas,"click",function(b){(b=Vc(this.c,b.offsetX,b.offsetY))&&this.Lc(b[0],b[1])&&a(this)},p,this)});
